<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploratory Analysis I: Using PCA to identify effort dimensions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html">Analysis: XGBoost</a></li><li class="breadcrumb-item"><a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html">Exploratory Analysis I: Using PCA to identify effort dimensions</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">XDF Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_XDF_processing/xdf_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-Processing I: from XDF to raw files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Motion Tracking Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">01_Video_preparation.ipynb</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">02_Track_OpenPose.ipynb</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/03_Track_pose2sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking III: Triangulation via Pose2sim</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/04_Track_InverseKinDyn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking IV: Modeling inverse kinematics and dynamics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Time Series Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_TS_processing/01_TS_processing_motion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing I: Motion tracking and balance</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">03_TS_processing/02_TS_processing_acoustics.html</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">03_TS_processing/03_TS_merging.html</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Time Series Annotation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/01_Classify_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation I: Preparing training data and data for classifier</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/02_MovementClassifier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation II: Training movement classifier, and annotating timeseries data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/03_InterAgreement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation III: Computing interrater agreement between manual and automatic annotation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Final Merge</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_finalMerge/TS_mergeAnnotations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final merge</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Concept Similarity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_ConceptSimilarity/ConceptNet_similarity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing concept similarity using ConceptNet word embeddings</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Feature Extraction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_TS_featureExtraction/TS_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extraction of effort-related features</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Analysis: XGBoost</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exploratory Analysis I: Using PCA to identify effort dimensions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_Analysis_XGBoost/02_XGBoost_effortIndicators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Analysis II: Identifying effort-related features contributing to misunderstanding resolution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Analysis: Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_Analysis_Modeling/Modelling_syntheticData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html">Analysis: XGBoost</a></li><li class="breadcrumb-item"><a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html">Exploratory Analysis I: Using PCA to identify effort dimensions</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exploratory Analysis I: Using PCA to identify effort dimensions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-pca" class="level2">
<h2 class="anchored" data-anchor-id="sec-pca">Overview</h2>
<p>In this notebook, we will use Principal Component Analysis (PCA) to identify the most relevant planes (components) of effort among the features in the dataset(s) we created in the previous script. We do this paralel to extreme gradient boosting (XGBoost, see <strong>?@sec-xgboost</strong>) because unlike PCA, XGBoost does not prevent from cummulating most relevant features that are correlated, i.e., they likely explain similar dimension of effort. To increase interpretative power of our analysis, we will combine these two methods to identify the most relevant features within the most relevant dimensions (i.e., components) of effort.</p>
<p>Note that the current version of the script is used with data only from dyad 0. Since this is not sufficient amount of data for any meaningful conclusions, this script serves for building the workflow. We will use identical pipeline with the full dataset, and any deviations from this script will be reported.</p>
<div id="cell-2" class="cell">
<details class="code-fold">
<summary>Code to prepare the environment</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>curfolder <span class="op">=</span> os.getcwd()</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This is where our features live</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">..</span><span class="ch">\\</span><span class="st">07_TS_featureExtraction</span><span class="ch">\\</span><span class="st">Datasets</span><span class="ch">\\</span><span class="st">'</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> glob.glob(features <span class="op">+</span> <span class="st">'*.csv'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Because within the three distinct modalities - gesture, vocalization, combined - a set of different components could be decisive to characterize effort, we will perform PCA on each modality separately.</p>
<div id="cell-4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is gesture data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ges <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> dfs <span class="cf">if</span> <span class="st">'gesture'</span> <span class="kw">in</span> x]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data_ges <span class="op">=</span> pd.read_csv(ges[<span class="dv">0</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This is vocalization data</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>voc <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> dfs <span class="cf">if</span> <span class="st">'vocal'</span> <span class="kw">in</span> x]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data_voc <span class="op">=</span> pd.read_csv(voc[<span class="dv">0</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This is multimodal data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>multi <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> dfs <span class="cf">if</span> <span class="st">'combination'</span> <span class="kw">in</span> x]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>data_multi <span class="op">=</span> pd.read_csv(multi[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca-gesture" class="level2">
<h2 class="anchored" data-anchor-id="pca-gesture">PCA: Gesture</h2>
<p>Let’s start by cleaning the dataframe. In gesture modality, some of the features are not relevant to the current analysis - those are mainly the ones that are related to acoustics and concept-related information. We will remove them from the dataframe before performing PCA.</p>
<div id="cell-6" class="cell">
<details class="code-fold">
<summary>Custom functions</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to clean the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_df(df, colstodel):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delete all desired columns</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.loc[:,<span class="op">~</span>df.columns.<span class="bu">str</span>.contains(<span class="st">'|'</span>.join(colstodel))]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill NaNs with 0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.fillna(<span class="dv">0</span>)   <span class="co"># FLAGGED: this we might change, maybe not the best method (alternative: MICE)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save values from correction_info</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    correction_info <span class="op">=</span> df[<span class="st">'correction_info'</span>]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Leave only numerical cols, except correction_info</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>,<span class="st">'int64'</span>])</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add back correction_info</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'correction_info'</span>] <span class="op">=</span> correction_info</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-7" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These are answer related columns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>conceptcols <span class="op">=</span> [<span class="st">'answer'</span>, <span class="st">'expressibility'</span>, <span class="st">'response'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># These are vocalization related columns</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>voccols <span class="op">=</span> [<span class="st">'envelope'</span>, <span class="st">'audio'</span>, <span class="st">'f0'</span>, <span class="st">'f1'</span>, <span class="st">'f2'</span>, <span class="st">'f3'</span>, <span class="st">'env_'</span>, <span class="st">'duration_voc'</span>, <span class="st">'CoG'</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate both lists</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>colstodel <span class="op">=</span> conceptcols <span class="op">+</span> voccols</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the df</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ges_clean <span class="op">=</span> clean_df(data_ges, colstodel)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>ges_clean.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">arm_duration</th>
<th data-quarto-table-cell-role="th">arm_inter_Kin</th>
<th data-quarto-table-cell-role="th">arm_inter_IK</th>
<th data-quarto-table-cell-role="th">arm_bbmv</th>
<th data-quarto-table-cell-role="th">lowerbody_duration</th>
<th data-quarto-table-cell-role="th">lowerbody_inter_Kin</th>
<th data-quarto-table-cell-role="th">lowerbody_inter_IK</th>
<th data-quarto-table-cell-role="th">lowerbody_bbmv</th>
<th data-quarto-table-cell-role="th">leg_duration</th>
<th data-quarto-table-cell-role="th">leg_inter_Kin</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">arm_asymmetry</th>
<th data-quarto-table-cell-role="th">arm_moment_sum_pospeak_mean</th>
<th data-quarto-table-cell-role="th">arm_power_pospeak_std</th>
<th data-quarto-table-cell-role="th">pelvis_moment_sum_change_pospeak_std</th>
<th data-quarto-table-cell-role="th">pelvis_moment_sum_pospeak_std</th>
<th data-quarto-table-cell-role="th">arm_moment_sum_pospeak_std</th>
<th data-quarto-table-cell-role="th">lowerbody_moment_sum_pospeak_std</th>
<th data-quarto-table-cell-role="th">lowerbody_power_pospeak_std</th>
<th data-quarto-table-cell-role="th">leg_moment_sum_change_pospeak_std</th>
<th data-quarto-table-cell-role="th">correction_info</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3816.0</td>
<td>28.001</td>
<td>29.471</td>
<td>10.348</td>
<td>3244.0</td>
<td>27.815</td>
<td>30.057</td>
<td>9.607</td>
<td>3244.0</td>
<td>27.788</td>
<td>...</td>
<td>-2481.688</td>
<td>-8.489</td>
<td>1.030</td>
<td>0.000</td>
<td>0.646</td>
<td>4.579</td>
<td>0.303</td>
<td>0.000</td>
<td>0.000</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5280.0</td>
<td>28.098</td>
<td>30.942</td>
<td>13.350</td>
<td>5862.0</td>
<td>28.648</td>
<td>31.235</td>
<td>17.882</td>
<td>5862.0</td>
<td>29.740</td>
<td>...</td>
<td>-2803.359</td>
<td>-0.430</td>
<td>1.682</td>
<td>0.213</td>
<td>0.907</td>
<td>1.201</td>
<td>0.409</td>
<td>0.000</td>
<td>0.513</td>
<td>c0_only</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4302.0</td>
<td>28.401</td>
<td>31.164</td>
<td>10.572</td>
<td>4206.0</td>
<td>28.373</td>
<td>31.096</td>
<td>8.402</td>
<td>4206.0</td>
<td>27.451</td>
<td>...</td>
<td>-6703.803</td>
<td>-6.312</td>
<td>0.348</td>
<td>0.000</td>
<td>1.403</td>
<td>3.175</td>
<td>1.227</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4474.0</td>
<td>27.316</td>
<td>30.376</td>
<td>10.229</td>
<td>4398.0</td>
<td>28.390</td>
<td>32.196</td>
<td>9.064</td>
<td>4398.0</td>
<td>27.665</td>
<td>...</td>
<td>-2827.356</td>
<td>-5.724</td>
<td>1.266</td>
<td>0.000</td>
<td>1.717</td>
<td>5.321</td>
<td>0.124</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4388.0</td>
<td>27.872</td>
<td>31.225</td>
<td>9.748</td>
<td>3782.0</td>
<td>27.458</td>
<td>30.479</td>
<td>8.428</td>
<td>3782.0</td>
<td>27.529</td>
<td>...</td>
<td>-3711.104</td>
<td>-1.685</td>
<td>0.000</td>
<td>0.012</td>
<td>1.045</td>
<td>3.724</td>
<td>0.270</td>
<td>0.000</td>
<td>0.000</td>
<td>c2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5852.0</td>
<td>29.417</td>
<td>32.048</td>
<td>10.675</td>
<td>5404.0</td>
<td>29.153</td>
<td>30.545</td>
<td>10.334</td>
<td>5404.0</td>
<td>29.056</td>
<td>...</td>
<td>-8208.505</td>
<td>-8.680</td>
<td>2.553</td>
<td>0.018</td>
<td>0.958</td>
<td>2.077</td>
<td>0.145</td>
<td>0.000</td>
<td>0.000</td>
<td>c0_only</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2736.0</td>
<td>26.324</td>
<td>27.656</td>
<td>6.547</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>...</td>
<td>-3005.988</td>
<td>0.645</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4256.0</td>
<td>28.675</td>
<td>29.776</td>
<td>8.148</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>...</td>
<td>-3988.156</td>
<td>-5.168</td>
<td>0.000</td>
<td>0.000</td>
<td>1.373</td>
<td>8.906</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2516.0</td>
<td>26.234</td>
<td>27.815</td>
<td>7.774</td>
<td>884.0</td>
<td>23.300</td>
<td>25.890</td>
<td>6.598</td>
<td>884.0</td>
<td>23.423</td>
<td>...</td>
<td>-6191.330</td>
<td>-2.486</td>
<td>0.000</td>
<td>0.000</td>
<td>0.909</td>
<td>4.152</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>4504.0</td>
<td>28.604</td>
<td>30.892</td>
<td>9.939</td>
<td>4266.0</td>
<td>27.764</td>
<td>29.475</td>
<td>11.045</td>
<td>4266.0</td>
<td>28.404</td>
<td>...</td>
<td>-9892.382</td>
<td>-5.280</td>
<td>1.533</td>
<td>0.000</td>
<td>0.688</td>
<td>1.350</td>
<td>0.390</td>
<td>0.356</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>5946.0</td>
<td>28.473</td>
<td>30.925</td>
<td>9.779</td>
<td>5136.0</td>
<td>28.712</td>
<td>30.358</td>
<td>9.084</td>
<td>5136.0</td>
<td>28.117</td>
<td>...</td>
<td>-8094.630</td>
<td>-14.464</td>
<td>0.000</td>
<td>0.142</td>
<td>0.512</td>
<td>0.984</td>
<td>0.865</td>
<td>0.000</td>
<td>0.039</td>
<td>c1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>6100.0</td>
<td>29.300</td>
<td>31.243</td>
<td>10.521</td>
<td>6030.0</td>
<td>29.592</td>
<td>30.960</td>
<td>9.672</td>
<td>6030.0</td>
<td>30.037</td>
<td>...</td>
<td>-6914.443</td>
<td>-4.261</td>
<td>0.850</td>
<td>0.000</td>
<td>0.552</td>
<td>0.636</td>
<td>0.283</td>
<td>0.000</td>
<td>0.000</td>
<td>c2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>3004.0</td>
<td>26.079</td>
<td>26.368</td>
<td>7.253</td>
<td>2686.0</td>
<td>28.219</td>
<td>27.971</td>
<td>4.870</td>
<td>2686.0</td>
<td>27.750</td>
<td>...</td>
<td>-1630.817</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.085</td>
<td>0.000</td>
<td>0.000</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>3918.0</td>
<td>28.358</td>
<td>28.936</td>
<td>8.394</td>
<td>3366.0</td>
<td>28.669</td>
<td>28.833</td>
<td>5.086</td>
<td>3366.0</td>
<td>28.617</td>
<td>...</td>
<td>-2136.578</td>
<td>-4.907</td>
<td>0.184</td>
<td>0.460</td>
<td>0.851</td>
<td>1.980</td>
<td>0.855</td>
<td>0.406</td>
<td>1.368</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3918.0</td>
<td>28.120</td>
<td>29.766</td>
<td>9.343</td>
<td>1692.0</td>
<td>26.370</td>
<td>26.244</td>
<td>4.733</td>
<td>1692.0</td>
<td>24.816</td>
<td>...</td>
<td>-1165.345</td>
<td>-11.533</td>
<td>0.299</td>
<td>0.202</td>
<td>1.278</td>
<td>2.726</td>
<td>0.000</td>
<td>0.140</td>
<td>0.000</td>
<td>c1</td>
</tr>
</tbody>
</table>

<p>15 rows × 325 columns</p>
</div>
</div>
</div>
</div>
<p>Now, we first standardize the data and apply PCA to extract principal components. We use custom function <code>PCA_biplot</code> (adapted from <a href="https://stackoverflow.com/questions/50796024/feature-variable-importance-after-a-pca-analysis">here</a>) to visualize the first two principal components. Data points are color-coded on the target variable (correction info) and red arrows represent the contributions of selected variables to the PC.</p>
<div id="cell-9" class="cell">
<details class="code-fold">
<summary>Custom functions</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot PCA results</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PCA_biplot(score, coeff, labels<span class="op">=</span><span class="va">None</span>, selected_vars<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    xs <span class="op">=</span> score[:, <span class="dv">0</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    ys <span class="op">=</span> score[:, <span class="dv">1</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> coeff.shape[<span class="dv">0</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    scalex <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> (xs.<span class="bu">max</span>() <span class="op">-</span> xs.<span class="bu">min</span>())</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    scaley <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> (ys.<span class="bu">max</span>() <span class="op">-</span> ys.<span class="bu">min</span>())</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure all arrays have the same length</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    min_length <span class="op">=</span> <span class="bu">min</span>(<span class="bu">len</span>(xs), <span class="bu">len</span>(ys), <span class="bu">len</span>(y))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Trim all arrays to the smallest length</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    xs_trimmed <span class="op">=</span> xs[:min_length]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    ys_trimmed <span class="op">=</span> ys[:min_length]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    y_trimmed <span class="op">=</span> y[:min_length]  <span class="co"># Adjust 'c' values to match</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))  <span class="co"># Increase figure size</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now plot safely</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    plt.scatter(xs_trimmed <span class="op">*</span> scalex, ys_trimmed <span class="op">*</span> scaley, c<span class="op">=</span>y_trimmed, cmap<span class="op">=</span><span class="st">"viridis"</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If selected_vars is provided, only plot these variables</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> selected_vars <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> selected_vars:</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            plt.arrow(<span class="dv">0</span>, <span class="dv">0</span>, coeff[i, <span class="dv">0</span>], coeff[i, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> labels <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                plt.text(coeff[i, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">1.15</span>, coeff[i, <span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.15</span>, <span class="st">"Var"</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>), </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                         color<span class="op">=</span><span class="st">'g'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                plt.text(coeff[i, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">1.15</span>, coeff[i, <span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.15</span>, labels[i], </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                         color<span class="op">=</span><span class="st">'g'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            plt.arrow(<span class="dv">0</span>, <span class="dv">0</span>, coeff[i, <span class="dv">0</span>], coeff[i, <span class="dv">1</span>], color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> labels <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                plt.text(coeff[i, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">1.15</span>, coeff[i, <span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.15</span>, <span class="st">"Var"</span> <span class="op">+</span> <span class="bu">str</span>(i <span class="op">+</span> <span class="dv">1</span>), </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                         color<span class="op">=</span><span class="st">'g'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                plt.text(coeff[i, <span class="dv">0</span>] <span class="op">*</span> <span class="fl">1.15</span>, coeff[i, <span class="dv">1</span>] <span class="op">*</span> <span class="fl">1.15</span>, labels[i], </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                         color<span class="op">=</span><span class="st">'g'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zoom into the plot by narrowing the axis limits</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    plt.xlim(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># Adjust the range as needed</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    plt.ylim(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)  <span class="co"># Adjust the range as needed</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"PC1"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"PC2"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"PCA Biplot"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> ges_clean.iloc[:, :<span class="op">-</span><span class="dv">1</span>].values  <span class="co"># All columns except the last as features</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ges_clean.iloc[:, <span class="op">-</span><span class="dv">1</span>].values   <span class="co"># Last column as target variable</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical target to numeric if necessary</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> y.dtype <span class="op">==</span> <span class="st">'object'</span> <span class="kw">or</span> y.dtype.name <span class="op">==</span> <span class="st">'category'</span>:</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> le.fit_transform(y)  <span class="co"># Converts categorical labels into numeric labels</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the data</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scaler.fit_transform(X)    </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA transformation</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>x_new <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># For intelligibility, let's select only plot some variables</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]  </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function. Use only the 2 PCs.</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>PCA_biplot(x_new[:, <span class="dv">0</span>:<span class="dv">2</span>], np.transpose(pca.components_[<span class="dv">0</span>:<span class="dv">2</span>, :]), selected_vars<span class="op">=</span>selected_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_PCA_featureDimensions_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What amount of variances each PC explains?</p>
<div id="cell-12" class="cell">
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([3.84511094e-01, 1.33517247e-01, 1.13255439e-01, 7.31860616e-02,
       4.06776991e-02, 3.60648304e-02, 3.37781522e-02, 2.58262475e-02,
       2.25049502e-02, 2.11170841e-02, 1.88455453e-02, 1.63285979e-02,
       1.42102152e-02, 1.37325090e-02, 1.14525593e-02, 1.05874031e-02,
       9.39941422e-03, 8.83676344e-03, 6.69106898e-03, 5.47711790e-03,
       8.22273514e-33])</code></pre>
</div>
</div>
<p>So we have really few data, therefore even the first principal component explains only 38% of the variance, second 13% and third 11%. But we will be focusing on the first three principal components, as they together explain at least 50% of the variance</p>
<p>Now we can check the most important features. The larger the absolute value of the Eigenvalue, the more important the feature is for the principal component.</p>
<div id="cell-15" class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[5.38681564e-02 5.19802363e-02 6.69687848e-02 ... 3.65783055e-02
  7.72739752e-03 1.33552992e-02]
 [4.86443290e-02 6.05250242e-02 6.33776285e-02 ... 3.84745526e-02
  3.50366562e-02 9.39677427e-02]
 [1.18950177e-02 3.18850132e-02 1.07001005e-02 ... 8.76759978e-02
  6.23252471e-02 3.70224151e-02]
 ...
 [6.91904948e-02 1.05956755e-01 5.99632890e-02 ... 2.86900649e-02
  2.45013548e-02 1.30355450e-02]
 [8.55970837e-03 1.99497041e-02 6.52238928e-02 ... 7.38606597e-02
  1.22245602e-01 2.97327756e-02]
 [2.14046104e-01 7.13652577e-01 1.35550979e-01 ... 5.87310753e-04
  8.63642051e-03 2.48636333e-03]]</code></pre>
</div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of principal components</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n_pcs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature names (excluding target column)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> ges_clean.columns[:<span class="op">-</span><span class="dv">1</span>]  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create storage for the ordered feature names and loadings</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>results_dict_ges <span class="op">=</span> {}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_pcs):</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all features sorted by absolute loading values</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    sorted_indices <span class="op">=</span> np.<span class="bu">abs</span>(pca.components_[i]).argsort()[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    sorted_features <span class="op">=</span> feature_names[sorted_indices]  <span class="co"># Feature names</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    sorted_loadings <span class="op">=</span> pca.components_[i, sorted_indices]  <span class="co"># Loadings</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store in dictionary</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    results_dict_ges[<span class="ss">f'PC</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> sorted_features.values</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    results_dict_ges[<span class="ss">f'PC</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">_Loading'</span>] <span class="op">=</span> sorted_loadings</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dictionary to DataFrame</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>results_df_ges <span class="op">=</span> pd.DataFrame(results_dict_ges)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>results_df_ges.head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PC1</th>
<th data-quarto-table-cell-role="th">PC1_Loading</th>
<th data-quarto-table-cell-role="th">PC2</th>
<th data-quarto-table-cell-role="th">PC2_Loading</th>
<th data-quarto-table-cell-role="th">PC3</th>
<th data-quarto-table-cell-role="th">PC3_Loading</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bbmv_total</td>
<td>0.088552</td>
<td>leg_moment_sum_change_integral</td>
<td>0.122350</td>
<td>lowerbody_angAcc_sum_Gstd</td>
<td>-0.113851</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>lowerbody_bbmv</td>
<td>0.088311</td>
<td>lowerbody_moment_sum_change_integral</td>
<td>0.119478</td>
<td>pelvis_moment_sum_integral</td>
<td>0.110988</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>leg_bbmv</td>
<td>0.088311</td>
<td>leg_moment_sum_range</td>
<td>0.118334</td>
<td>lowerbody_power_pospeak_n</td>
<td>-0.110353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>leg_angSpeed_sum_range</td>
<td>0.086581</td>
<td>leg_moment_sum_Gstd</td>
<td>0.117526</td>
<td>numofArt</td>
<td>0.106303</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>arm_bbmv</td>
<td>0.086062</td>
<td>leg_moment_sum_pospeak_std</td>
<td>0.117384</td>
<td>lowerbody_power_range</td>
<td>-0.105257</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>lowerbody_accKin_sum_pospeak_n</td>
<td>0.085862</td>
<td>leg_moment_sum_change_Gmean</td>
<td>0.111512</td>
<td>leg_angAcc_sum_integral</td>
<td>0.104674</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>lowerbody_speedKin_sum_pospeak_n</td>
<td>0.085862</td>
<td>leg_moment_sum_change_pospeak_n</td>
<td>0.110876</td>
<td>lowerbody_power_Gstd</td>
<td>-0.104521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>leg_angSpeed_sum_Gstd</td>
<td>0.084579</td>
<td>arm_angSpeed_sum_Gstd</td>
<td>-0.106664</td>
<td>lowerbody_angAcc_sum_range</td>
<td>-0.104089</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>head_speedKin_sum_pospeak_std</td>
<td>0.083995</td>
<td>spine_moment_sum_integral</td>
<td>-0.106053</td>
<td>spine_moment_sum_change_integral</td>
<td>-0.103468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>head_accKin_sum_pospeak_std</td>
<td>0.083995</td>
<td>lowerbody_moment_sum_change_range</td>
<td>0.105053</td>
<td>leg_angJerk_sum_integral</td>
<td>0.103358</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>head_bbmv</td>
<td>0.083770</td>
<td>arm_angSpeed_sum_range</td>
<td>-0.104518</td>
<td>spine_moment_sum_Gmean</td>
<td>-0.103014</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>leg_angJerk_sum_range</td>
<td>0.083486</td>
<td>head_angSpeed_sum_pospeak_std</td>
<td>0.102664</td>
<td>lowerbody_angSpeed_sum_Gstd</td>
<td>-0.102256</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>leg_speedKin_sum_range</td>
<td>0.083428</td>
<td>head_angAcc_sum_pospeak_std</td>
<td>0.102664</td>
<td>leg_angSpeed_sum_integral</td>
<td>0.101966</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>head_accKin_sum_range</td>
<td>0.082507</td>
<td>spine_moment_sum_Gmean</td>
<td>-0.102477</td>
<td>spine_moment_sum_integral</td>
<td>-0.101497</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>head_jerkKin_sum_integral</td>
<td>0.082302</td>
<td>spine_moment_sum_change_Gstd</td>
<td>0.101442</td>
<td>pelvis_moment_sum_Gmean</td>
<td>0.100055</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>leg_duration</td>
<td>0.082105</td>
<td>lowerbody_moment_sum_Gstd</td>
<td>0.101287</td>
<td>leg_angJerk_sum_pospeak_mean</td>
<td>0.099828</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>lowerbody_duration</td>
<td>0.082105</td>
<td>lowerbody_moment_sum_change_Gstd</td>
<td>0.101006</td>
<td>lowerbody_angSpeed_sum_range</td>
<td>-0.099430</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>head_accKin_sum_Gstd</td>
<td>0.082004</td>
<td>lowerbody_moment_sum_range</td>
<td>0.100636</td>
<td>spine_moment_sum_change_Gmean</td>
<td>-0.099217</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>lowerbody_accKin_sum_range</td>
<td>0.081567</td>
<td>lowerbody_moment_sum_change_Gmean</td>
<td>0.100220</td>
<td>pelvis_moment_sum_change_Gstd</td>
<td>-0.098610</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>leg_angAcc_sum_range</td>
<td>0.081196</td>
<td>head_moment_sum_change_Gmean</td>
<td>0.099953</td>
<td>leg_angJerk_sum_Gmean</td>
<td>0.097263</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Now we have dataframe for gesture modality where each column represents a principal component (PC1-PC3) and each row represents a feature. The values in the dataframe are the loadings of the features on the principal components. The loadings are the correlation coefficients between the features and the principal components. The higher the absolute value of the loading, the more important the feature is for the principal component. The dataframe is sorted by the absolute value of the loadings in descending order.</p>
<p>Save the top contributors as a file so that we can load it in for the XGBoost analysis. We will also save the clean data which we can use for XGBoost modeling too.</p>
<div id="cell-19" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save top contributors</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>results_df_ges.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">PCA_top_contributors_ges.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save clean data</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ges_clean.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">ges_clean_df.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca-vocalizations" class="level2">
<h2 class="anchored" data-anchor-id="pca-vocalizations">PCA: Vocalizations</h2>
<p>In the following repetitions, we will use custom function <code>pca_analysis</code> which does all the steps we performed previously for gesture modality in one go</p>
<div id="cell-22" class="cell">
<details class="code-fold">
<summary>Custom PCA function</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pca_analysis(df_clean):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare data</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_clean.iloc[:, :<span class="op">-</span><span class="dv">1</span>].values  <span class="co"># All columns except the last as features</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_clean.iloc[:, <span class="op">-</span><span class="dv">1</span>].values   <span class="co"># Last column as target variable</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert categorical target to numeric if necessary</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> y.dtype <span class="op">==</span> <span class="st">'object'</span> <span class="kw">or</span> y.dtype.name <span class="op">==</span> <span class="st">'category'</span>:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        le <span class="op">=</span> LabelEncoder()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> le.fit_transform(y)  <span class="co"># Converts categorical labels into numeric labels</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale the data</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> scaler.fit_transform(X)    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PCA transformation</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    pca <span class="op">=</span> PCA()</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    x_new <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select few variables</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]  </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Biplot for the first 2 PCs:'</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    PCA_biplot(x_new[:, <span class="dv">0</span>:<span class="dv">2</span>], np.transpose(pca.components_[<span class="dv">0</span>:<span class="dv">2</span>, :]), selected_vars<span class="op">=</span>selected_vars)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    PC1explained <span class="op">=</span> pca.explained_variance_ratio_[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    PC2explained <span class="op">=</span> pca.explained_variance_ratio_[<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    PC3explained <span class="op">=</span> pca.explained_variance_ratio_[<span class="dv">2</span>]<span class="op">*</span><span class="dv">100</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'PCs explained variance:'</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'PC1: </span><span class="sc">{</span>PC1explained<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'PC2: </span><span class="sc">{</span>PC2explained<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'PC3: </span><span class="sc">{</span>PC3explained<span class="sc">:.2f}</span><span class="ss">%'</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Getting most contributing features</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    n_pcs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feature names (excluding target column)</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> df_clean.columns[:<span class="op">-</span><span class="dv">1</span>]  </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create storage for the ordered feature names and loadings</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    results_dict <span class="op">=</span> {}</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_pcs):</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get all features sorted by absolute loading values</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        sorted_indices <span class="op">=</span> np.<span class="bu">abs</span>(pca.components_[i]).argsort()[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        sorted_features <span class="op">=</span> feature_names[sorted_indices]  <span class="co"># Feature names</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        sorted_loadings <span class="op">=</span> pca.components_[i, sorted_indices]  <span class="co"># Loadings</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store in dictionary</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        results_dict[<span class="ss">f'PC</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>] <span class="op">=</span> sorted_features.values</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        results_dict[<span class="ss">f'PC</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">_Loading'</span>] <span class="op">=</span> sorted_loadings</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert dictionary to DataFrame</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    results_df <span class="op">=</span> pd.DataFrame(results_dict)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before PCA, we need to clean the data such that only vocalization-relevant features are kept.</p>
<div id="cell-24" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These are answer related columns</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>conceptcols <span class="op">=</span> [<span class="st">'answer'</span>, <span class="st">'expressibility'</span>, <span class="st">'response'</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># These are vocalization related columns</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>voccols <span class="op">=</span> [<span class="st">'envelope'</span>, <span class="st">'audio'</span>, <span class="st">'f0'</span>, <span class="st">'f1'</span>, <span class="st">'f2'</span>, <span class="st">'f3'</span>, <span class="st">'env_'</span>, <span class="st">'duration_voc'</span>, <span class="st">'CoG'</span>, <span class="st">'correction_info'</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate both lists</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>colstodel <span class="op">=</span> conceptcols </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the df</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>voc_clean <span class="op">=</span> clean_df(data_voc, colstodel)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only those cols that have some in name - at least partially - words from voccols</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>colstokeep <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> voc_clean.columns <span class="cf">if</span> <span class="bu">any</span>(word <span class="kw">in</span> col <span class="cf">for</span> word <span class="kw">in</span> voccols)]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only those columns</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>voc_clean <span class="op">=</span> voc_clean[colstokeep]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>voc_clean.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">envelope_Gmean</th>
<th data-quarto-table-cell-role="th">envelope_Gstd</th>
<th data-quarto-table-cell-role="th">envelope_pospeak_mean</th>
<th data-quarto-table-cell-role="th">envelope_pospeak_std</th>
<th data-quarto-table-cell-role="th">envelope_pospeak_n</th>
<th data-quarto-table-cell-role="th">envelope_integral</th>
<th data-quarto-table-cell-role="th">envelope_range</th>
<th data-quarto-table-cell-role="th">envelope_change_Gmean</th>
<th data-quarto-table-cell-role="th">envelope_change_Gstd</th>
<th data-quarto-table-cell-role="th">envelope_change_pospeak_mean</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">f2_clean_pospeak_std</th>
<th data-quarto-table-cell-role="th">f1_clean_pospeak_std</th>
<th data-quarto-table-cell-role="th">f1_clean_vel_pospeak_std</th>
<th data-quarto-table-cell-role="th">CoG_Gmean</th>
<th data-quarto-table-cell-role="th">CoG_Gstd</th>
<th data-quarto-table-cell-role="th">CoG_pospeak_mean</th>
<th data-quarto-table-cell-role="th">CoG_pospeak_std</th>
<th data-quarto-table-cell-role="th">CoG_integral</th>
<th data-quarto-table-cell-role="th">CoG_range</th>
<th data-quarto-table-cell-role="th">correction_info</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.288</td>
<td>1.438</td>
<td>0.297</td>
<td>2.393</td>
<td>6.0</td>
<td>337.541</td>
<td>7.888</td>
<td>0.016</td>
<td>0.788</td>
<td>0.042</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.805</td>
<td>2.106</td>
<td>-0.586</td>
<td>0.231</td>
<td>5.0</td>
<td>1417.739</td>
<td>7.888</td>
<td>-0.258</td>
<td>0.367</td>
<td>-0.336</td>
<td>...</td>
<td>0.685</td>
<td>0.11</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.281</td>
<td>1.843</td>
<td>-0.584</td>
<td>0.196</td>
<td>3.0</td>
<td>357.523</td>
<td>7.889</td>
<td>-0.243</td>
<td>0.505</td>
<td>-0.542</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.446</td>
<td>1.907</td>
<td>-0.641</td>
<td>0.118</td>
<td>3.0</td>
<td>359.095</td>
<td>7.858</td>
<td>-0.122</td>
<td>0.714</td>
<td>-0.572</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.804</td>
<td>1.927</td>
<td>0.003</td>
<td>0.728</td>
<td>7.0</td>
<td>916.490</td>
<td>7.888</td>
<td>0.037</td>
<td>0.890</td>
<td>-0.266</td>
<td>...</td>
<td>1.624</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.779</td>
<td>2.046</td>
<td>1.788</td>
<td>4.266</td>
<td>3.0</td>
<td>1116.787</td>
<td>7.853</td>
<td>-0.149</td>
<td>0.674</td>
<td>-0.237</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>1.777</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.317</td>
<td>1.751</td>
<td>-0.500</td>
<td>0.001</td>
<td>5.0</td>
<td>421.491</td>
<td>7.713</td>
<td>-0.144</td>
<td>0.857</td>
<td>-0.571</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2.471</td>
<td>2.336</td>
<td>-0.592</td>
<td>0.000</td>
<td>2.0</td>
<td>781.091</td>
<td>7.686</td>
<td>0.463</td>
<td>0.957</td>
<td>-0.572</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1.174</td>
<td>2.096</td>
<td>3.063</td>
<td>5.167</td>
<td>2.0</td>
<td>766.878</td>
<td>7.815</td>
<td>-0.077</td>
<td>0.772</td>
<td>-0.572</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>0.263</td>
<td>1.589</td>
<td>-0.472</td>
<td>0.430</td>
<td>8.0</td>
<td>447.570</td>
<td>7.889</td>
<td>0.098</td>
<td>0.896</td>
<td>-0.191</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>0.994</td>
<td>1.856</td>
<td>-0.492</td>
<td>0.000</td>
<td>8.0</td>
<td>1208.357</td>
<td>7.887</td>
<td>0.481</td>
<td>1.182</td>
<td>-0.572</td>
<td>...</td>
<td>0.463</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.233</td>
<td>2.069</td>
<td>-0.435</td>
<td>0.000</td>
<td>6.0</td>
<td>1144.241</td>
<td>7.884</td>
<td>0.564</td>
<td>1.231</td>
<td>-0.572</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>-0.561</td>
<td>1.464</td>
<td>-0.270</td>
<td>0.232</td>
<td>-518.310</td>
<td>5.346</td>
<td>c2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>...</td>
<td>0.000</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2.322</td>
<td>2.804</td>
<td>0.395</td>
<td>1.654</td>
<td>6.0</td>
<td>2303.726</td>
<td>7.888</td>
<td>0.751</td>
<td>1.304</td>
<td>-0.238</td>
<td>...</td>
<td>1.347</td>
<td>0.00</td>
<td>0.005</td>
<td>-3.272</td>
<td>0.375</td>
<td>-0.528</td>
<td>2.491</td>
<td>-3242.007</td>
<td>2.236</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3.156</td>
<td>2.213</td>
<td>2.712</td>
<td>3.700</td>
<td>4.0</td>
<td>3206.970</td>
<td>7.889</td>
<td>-0.137</td>
<td>0.681</td>
<td>-0.466</td>
<td>...</td>
<td>0.372</td>
<td>0.00</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>c1</td>
</tr>
</tbody>
</table>

<p>15 rows × 71 columns</p>
</div>
</div>
</div>
</div>
<p>Now we can use the function to perform the same PCA analysis but on vocal features</p>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA analysis</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>results_df_voc <span class="op">=</span> pca_analysis(voc_clean)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>results_df_voc.head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Biplot for the first 2 PCs:
PCs explained variance:
PC1: 23.02%
PC2: 15.73%
PC3: 12.03%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_PCA_featureDimensions_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PC1</th>
<th data-quarto-table-cell-role="th">PC1_Loading</th>
<th data-quarto-table-cell-role="th">PC2</th>
<th data-quarto-table-cell-role="th">PC2_Loading</th>
<th data-quarto-table-cell-role="th">PC3</th>
<th data-quarto-table-cell-role="th">PC3_Loading</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>f3_clean_vel_pospeak_n</td>
<td>-0.227090</td>
<td>f3_clean_vel_pospeak_mean</td>
<td>-0.249509</td>
<td>CoG_integral</td>
<td>-0.294560</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>f3_clean_pospeak_n</td>
<td>-0.225100</td>
<td>f0_Gstd</td>
<td>0.245291</td>
<td>CoG_pospeak_std</td>
<td>0.279256</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>f2_clean_vel_pospeak_n</td>
<td>-0.223553</td>
<td>f0_pospeak_n</td>
<td>0.244768</td>
<td>CoG_pospeak_n</td>
<td>0.274855</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>f2_clean_vel_range</td>
<td>-0.209338</td>
<td>f0_range</td>
<td>0.240540</td>
<td>envelope_change_Gmean</td>
<td>0.254844</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>f2_clean_Gstd</td>
<td>-0.207581</td>
<td>f3_clean_vel_pospeak_std</td>
<td>0.205998</td>
<td>CoG_Gmean</td>
<td>-0.250294</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>f1_clean_vel_range</td>
<td>-0.204405</td>
<td>f3_clean_pospeak_mean</td>
<td>0.202094</td>
<td>CoG_range</td>
<td>0.248384</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>f1_clean_range</td>
<td>-0.203867</td>
<td>envelope_integral</td>
<td>-0.172313</td>
<td>f1_clean_pospeak_mean</td>
<td>-0.226109</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>f2_clean_range</td>
<td>-0.201218</td>
<td>f2_clean_vel_pospeak_mean</td>
<td>-0.169850</td>
<td>envelope_change_integral</td>
<td>0.219129</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>f2_clean_pospeak_n</td>
<td>-0.199212</td>
<td>f1_clean_vel_integral</td>
<td>-0.165138</td>
<td>CoG_Gstd</td>
<td>0.218615</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>VSA_f1f2</td>
<td>-0.198116</td>
<td>f2_clean_integral</td>
<td>0.165138</td>
<td>f2_clean_vel_pospeak_std</td>
<td>0.212810</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>f3_clean_range</td>
<td>-0.173889</td>
<td>f3_clean_vel_integral</td>
<td>-0.165138</td>
<td>envelope_change_Gstd</td>
<td>0.203972</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>f1_clean_vel_pospeak_n</td>
<td>-0.171451</td>
<td>f2_clean_vel_integral</td>
<td>-0.165138</td>
<td>envelope_Gstd</td>
<td>0.170814</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>f2_clean_vel_Gstd</td>
<td>-0.170596</td>
<td>f1_clean_integral</td>
<td>0.165138</td>
<td>f2_clean_pospeak_mean</td>
<td>-0.147427</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>f3_clean_vel_range</td>
<td>-0.164741</td>
<td>f3_clean_integral</td>
<td>0.165138</td>
<td>f2_clean_pospeak_std</td>
<td>0.142625</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>f1_clean_pospeak_n</td>
<td>-0.163461</td>
<td>f0_Gmean</td>
<td>-0.164620</td>
<td>envelope_Gmean</td>
<td>0.140345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>f1_clean_Gstd</td>
<td>-0.160931</td>
<td>envelope_change_integral</td>
<td>0.163419</td>
<td>envelope_change_pospeak_n</td>
<td>0.131470</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>f1_clean_vel_Gstd</td>
<td>-0.143258</td>
<td>f1_clean_vel_pospeak_n</td>
<td>0.163373</td>
<td>f1_clean_pospeak_n</td>
<td>-0.128745</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>envelope_change_range</td>
<td>-0.141037</td>
<td>f3_clean_Gmean</td>
<td>0.149983</td>
<td>f1_clean_Gstd</td>
<td>-0.127111</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>f3_clean_Gstd</td>
<td>-0.138584</td>
<td>envelope_Gstd</td>
<td>-0.148065</td>
<td>f3_clean_pospeak_mean</td>
<td>-0.126233</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>f3_clean_vel_pospeak_std</td>
<td>-0.135056</td>
<td>envelope_Gmean</td>
<td>-0.148007</td>
<td>envelope_change_range</td>
<td>0.124729</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Save contributors as a file</p>
<div id="cell-28" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save top contributors</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>results_df_voc.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">PCA_top_contributors_voc.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save clean data</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>voc_clean.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">voc_clean_df.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca-combined" class="level2">
<h2 class="anchored" data-anchor-id="pca-combined">PCA: Combined</h2>
<p>Now we do the same for combined condition</p>
<div id="cell-31" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These are answer related columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>conceptcols <span class="op">=</span> [<span class="st">'answer'</span>, <span class="st">'expressibility'</span>, <span class="st">'response'</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate both lists</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>colstodel <span class="op">=</span> conceptcols </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the df</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>multi_clean <span class="op">=</span> clean_df(data_multi, colstodel)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>multi_clean.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">arm_duration</th>
<th data-quarto-table-cell-role="th">arm_inter_Kin</th>
<th data-quarto-table-cell-role="th">arm_inter_IK</th>
<th data-quarto-table-cell-role="th">arm_bbmv</th>
<th data-quarto-table-cell-role="th">lowerbody_duration</th>
<th data-quarto-table-cell-role="th">lowerbody_inter_Kin</th>
<th data-quarto-table-cell-role="th">lowerbody_inter_IK</th>
<th data-quarto-table-cell-role="th">lowerbody_bbmv</th>
<th data-quarto-table-cell-role="th">leg_duration</th>
<th data-quarto-table-cell-role="th">leg_inter_Kin</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">f2_clean_pospeak_std</th>
<th data-quarto-table-cell-role="th">f1_clean_pospeak_std</th>
<th data-quarto-table-cell-role="th">f1_clean_vel_pospeak_std</th>
<th data-quarto-table-cell-role="th">CoG_Gmean</th>
<th data-quarto-table-cell-role="th">CoG_Gstd</th>
<th data-quarto-table-cell-role="th">CoG_pospeak_mean</th>
<th data-quarto-table-cell-role="th">CoG_pospeak_std</th>
<th data-quarto-table-cell-role="th">CoG_integral</th>
<th data-quarto-table-cell-role="th">CoG_range</th>
<th data-quarto-table-cell-role="th">correction_info</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3988.0</td>
<td>26.197</td>
<td>26.728</td>
<td>8.472</td>
<td>2020.0</td>
<td>26.580</td>
<td>26.181</td>
<td>5.400</td>
<td>2020.0</td>
<td>26.759</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3868.0</td>
<td>26.674</td>
<td>28.122</td>
<td>8.148</td>
<td>2870.0</td>
<td>28.319</td>
<td>28.291</td>
<td>6.487</td>
<td>2870.0</td>
<td>27.096</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4014.0</td>
<td>26.449</td>
<td>27.565</td>
<td>8.465</td>
<td>874.0</td>
<td>23.434</td>
<td>23.040</td>
<td>2.861</td>
<td>874.0</td>
<td>22.945</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4046.0</td>
<td>26.207</td>
<td>28.558</td>
<td>8.482</td>
<td>3750.0</td>
<td>28.421</td>
<td>28.796</td>
<td>6.124</td>
<td>3750.0</td>
<td>27.973</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4708.0</td>
<td>26.502</td>
<td>28.717</td>
<td>8.309</td>
<td>4508.0</td>
<td>29.760</td>
<td>28.762</td>
<td>6.005</td>
<td>4508.0</td>
<td>28.679</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4004.0</td>
<td>26.978</td>
<td>28.554</td>
<td>8.699</td>
<td>3598.0</td>
<td>28.801</td>
<td>28.616</td>
<td>5.723</td>
<td>3598.0</td>
<td>28.179</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>784.0</td>
<td>23.222</td>
<td>22.753</td>
<td>2.313</td>
<td>784.0</td>
<td>22.135</td>
<td>...</td>
<td>0.867</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>5248.0</td>
<td>28.973</td>
<td>31.658</td>
<td>10.919</td>
<td>4930.0</td>
<td>28.905</td>
<td>29.800</td>
<td>14.893</td>
<td>4930.0</td>
<td>28.250</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1784.0</td>
<td>25.011</td>
<td>24.190</td>
<td>6.604</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1284.0</td>
<td>24.278</td>
<td>24.516</td>
<td>5.054</td>
<td>1334.0</td>
<td>25.381</td>
<td>25.483</td>
<td>4.317</td>
<td>1334.0</td>
<td>24.478</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>1494.0</td>
<td>24.248</td>
<td>24.502</td>
<td>6.483</td>
<td>2944.0</td>
<td>29.247</td>
<td>28.630</td>
<td>5.378</td>
<td>2944.0</td>
<td>26.524</td>
<td>...</td>
<td>0.000</td>
<td>0.018</td>
<td>0.812</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2486.0</td>
<td>25.718</td>
<td>26.035</td>
<td>6.420</td>
<td>780.0</td>
<td>25.181</td>
<td>21.982</td>
<td>2.271</td>
<td>780.0</td>
<td>22.482</td>
<td>...</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0_only</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2968.0</td>
<td>25.494</td>
<td>28.758</td>
<td>8.040</td>
<td>2750.0</td>
<td>28.377</td>
<td>27.107</td>
<td>4.885</td>
<td>2750.0</td>
<td>26.672</td>
<td>...</td>
<td>0.618</td>
<td>0.000</td>
<td>0.552</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>3850.0</td>
<td>27.666</td>
<td>27.348</td>
<td>7.419</td>
<td>3366.0</td>
<td>28.208</td>
<td>28.519</td>
<td>5.033</td>
<td>3366.0</td>
<td>28.230</td>
<td>...</td>
<td>0.223</td>
<td>0.000</td>
<td>0.502</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3236.0</td>
<td>26.551</td>
<td>27.446</td>
<td>6.411</td>
<td>0.0</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>...</td>
<td>0.197</td>
<td>0.429</td>
<td>0.347</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>c1</td>
</tr>
</tbody>
</table>

<p>15 rows × 395 columns</p>
</div>
</div>
</div>
</div>
<p>Now we can use the function to perform the same PCA analysis but all (i.e., both vocal and gestural) features</p>
<div id="cell-33" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA analysis</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>results_df_multi <span class="op">=</span> pca_analysis(multi_clean)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>results_df_multi.head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Biplot for the first 2 PCs:
PCs explained variance:
PC1: 32.33%
PC2: 12.86%
PC3: 8.72%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_PCA_featureDimensions_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PC1</th>
<th data-quarto-table-cell-role="th">PC1_Loading</th>
<th data-quarto-table-cell-role="th">PC2</th>
<th data-quarto-table-cell-role="th">PC2_Loading</th>
<th data-quarto-table-cell-role="th">PC3</th>
<th data-quarto-table-cell-role="th">PC3_Loading</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>lowerbody_speedKin_sum_range</td>
<td>0.084947</td>
<td>pelvis_moment_sum_change_pospeak_n</td>
<td>-0.108598</td>
<td>pelvis_moment_sum_Gmean</td>
<td>-0.131078</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>lowerbody_speedKin_sum_Gstd</td>
<td>0.084128</td>
<td>lowerbody_moment_sum_change_pospeak_n</td>
<td>-0.102210</td>
<td>leg_moment_sum_change_pospeak_std</td>
<td>0.126453</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>lowerbody_accKin_sum_range</td>
<td>0.083025</td>
<td>envelope_change_range</td>
<td>-0.095835</td>
<td>pelvis_moment_sum_change_Gmean</td>
<td>0.125537</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>leg_angAcc_sum_range</td>
<td>0.082578</td>
<td>leg_moment_sum_pospeak_n</td>
<td>-0.095587</td>
<td>pelvis_moment_sum_integral</td>
<td>-0.125378</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>bbmv_total</td>
<td>0.082215</td>
<td>leg_angAcc_sum_pospeak_mean</td>
<td>0.095287</td>
<td>leg_moment_sum_change_pospeak_mean</td>
<td>0.123384</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>leg_angJerk_sum_range</td>
<td>0.082004</td>
<td>leg_angSpeed_sum_pospeak_mean</td>
<td>0.095287</td>
<td>lowerbody_jerkKin_sum_pospeak_mean</td>
<td>0.120110</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>lowerbody_accKin_sum_Gstd</td>
<td>0.081860</td>
<td>lowerbody_moment_sum_change_pospeak_std</td>
<td>-0.090847</td>
<td>leg_moment_sum_change_pospeak_n</td>
<td>0.114781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>leg_angSpeed_sum_range</td>
<td>0.081268</td>
<td>leg_moment_sum_pospeak_std</td>
<td>-0.090727</td>
<td>lowerbody_moment_sum_change_Gmean</td>
<td>0.114695</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>head_angJerk_sum_range</td>
<td>0.081148</td>
<td>envelope_change_pospeak_n</td>
<td>-0.090655</td>
<td>leg_moment_sum_change_Gmean</td>
<td>0.114310</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>head_angJerk_sum_Gstd</td>
<td>0.080572</td>
<td>f0_range</td>
<td>-0.090308</td>
<td>pelvis_moment_sum_pospeak_mean</td>
<td>-0.113300</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>pelvis_moment_sum_range</td>
<td>0.080076</td>
<td>f1_clean_vel_pospeak_n</td>
<td>-0.090298</td>
<td>pelvis_moment_sum_change_integral</td>
<td>0.111752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>lowerbody_speedKin_sum_integral</td>
<td>0.079815</td>
<td>f3_clean_vel_pospeak_n</td>
<td>-0.089649</td>
<td>f1_clean_vel_pospeak_std</td>
<td>0.107322</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>leg_angAcc_sum_Gstd</td>
<td>0.079559</td>
<td>leg_moment_sum_Gstd</td>
<td>-0.089473</td>
<td>lowerbody_moment_sum_integral</td>
<td>-0.105503</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>head_angJerk_sum_Gmean</td>
<td>0.079513</td>
<td>head_jerkKin_sum_pospeak_mean</td>
<td>0.088606</td>
<td>lowerbody_moment_sum_change_integral</td>
<td>0.105260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>arm_angJerk_sum_integral</td>
<td>0.079455</td>
<td>f0_Gstd</td>
<td>-0.088475</td>
<td>lowerbody_angAcc_sum_Gstd</td>
<td>0.104757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>leg_power_integral</td>
<td>0.079208</td>
<td>spine_moment_sum_change_pospeak_n</td>
<td>-0.087931</td>
<td>lowerbody_moment_sum_Gmean</td>
<td>-0.103744</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>leg_angJerk_sum_Gstd</td>
<td>0.079082</td>
<td>lowerbody_moment_sum_change_Gstd</td>
<td>-0.087358</td>
<td>lowerbody_jerkKin_sum_pospeak_std</td>
<td>0.102416</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>leg_angSpeed_sum_Gstd</td>
<td>0.078558</td>
<td>leg_jerkKin_sum_pospeak_mean</td>
<td>0.087297</td>
<td>leg_moment_sum_change_integral</td>
<td>0.102272</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>head_accKin_sum_integral</td>
<td>0.078307</td>
<td>lowerbody_power_pospeak_n</td>
<td>-0.087118</td>
<td>lowerbody_angAcc_sum_range</td>
<td>0.098288</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>arm_angSpeed_sum_pospeak_std</td>
<td>0.078266</td>
<td>f2_clean_vel_pospeak_n</td>
<td>-0.086946</td>
<td>lowerbody_moment_sum_change_range</td>
<td>0.095950</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save top contributors</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>results_df_multi.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">PCA_top_contributors_multi.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save clean data</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>multi_clean.to_csv(curfolder <span class="op">+</span> <span class="st">'</span><span class="ch">\\</span><span class="st">datasets</span><span class="ch">\\</span><span class="st">multi_clean_df.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>