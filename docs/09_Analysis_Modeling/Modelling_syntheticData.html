<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
        <div class="quarto-navbar-tools tools-end">
    <a href="https://bsky.app/profile/sarkadava.bsky.social" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-bluesky"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://code.com">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://bugs.com">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../06_ConceptSimilarity/ConceptNet_similarity.html">Analysis</a></li><li class="breadcrumb-item"><a href="../09_Analysis_Modeling/Modelling_syntheticData.html">Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_XDF_processing/xdf_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-Processing I: from XDF to raw files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/01_Video_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking I: Preparation of videos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/02_Track_OpenPose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking II: 2D pose estimation via OpenPose</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/03_Track_pose2sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking III: Triangulation via Pose2sim</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_MotionTracking_processing/04_Track_InverseKinDyn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motion tracking IV: Modeling inverse kinematics and dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_TS_processing/01_TS_processing_motion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing I: Motion tracking and balance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_TS_processing/02_TS_processing_acoustics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing II: Acoustics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_TS_processing/03_TS_merging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing III: Merging multimodal data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Time Series Annotation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/01_Classify_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation I: Preparing training data and data for classifier</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/02_MovementClassifier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation II: Training movement classifier, and annotating timeseries data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_TS_movementAnnotation/03_InterAgreement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Movement annotation III: Computing interrater agreement between manual and automatic annotation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_finalMerge/TS_mergeAnnotations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final merge</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_ConceptSimilarity/ConceptNet_similarity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing concept similarity using ConceptNet word embeddings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_TS_featureExtraction/TS_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extraction of effort-related features</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_Analysis_XGBoost/01_PCA_featureDimensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Analysis I: Using PCA to identify effort dimensions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_Analysis_XGBoost/02_XGBoost_effortIndicators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Analysis II: Identifying effort-related features contributing to misunderstanding resolution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_Analysis_Modeling/Modelling_syntheticData.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../06_ConceptSimilarity/ConceptNet_similarity.html">Analysis</a></li><li class="breadcrumb-item"><a href="../09_Analysis_Modeling/Modelling_syntheticData.html">Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Statistical Analysis: Modelling the Effect of Communicative Attempt (H1) and Answer Similarity (H2) on Effort</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-stats" class="level1">
<h1>Overview</h1>
<p>In this script, we will be modelling the causal relation between effort and correction to confirm/reject our hypothesis.</p>
<p>These are:</p>
<p>H1: In corrections, people enhance some effort-related kinematic and/or acoustic features of their behaviour relative to the baseline.</p>
<p>H2: The enhancement depends on similarity of the guesser’s answer and the original meaning. More similar answer will require/result in smaller enhancement (but still enhancement) than less similar answer.</p>
<p>To assess the design and performance of the model, we will use synthetic data that we create to have certain interdependencies and where the effects have pre-defined values. We use this approach instead of using our dyad 0 data, because the pilot data do not include enough data to have a sensible testing sample.</p>
<p>The confirmatory analysis concerns six outcome variables, namely integral of torque change, integral of amplitude envelope, integral of change in center of pressure, and mean peak value of torque change, mean peak value of amplitude envelope, and mean peak value of change in center of pressure.</p>
<p>For our exploratory analysis, we will model variables that will result as most predictive in relation to communicative attempt, assessed by <a href="../08_Analysis_XGBoost/02_XGBoost_effortIndicators.html#sec-xgboost">XGBoost modelling</a>. This is why in our synthetic data, we create a variable <em>Effort</em> that is continuous, but oterwise free of any other assumptions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code to prepare the environment</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for data-wrangling</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)  <span class="co"># for reshaping data (if needed)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcartocolor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag) <span class="co"># for dag</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot) <span class="co"># bayesian stuff</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beepr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines) <span class="co"># for bsplines</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># for lognormal transformations</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># current folder (first go to session -&gt; set working directory -&gt; to source file location)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>curfolder <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>parentfolder <span class="ot">&lt;-</span> <span class="fu">dirname</span>(curfolder)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>featurefolder <span class="ot">&lt;-</span> <span class="fu">paste0</span>(parentfolder, <span class="st">'/07_TS_featureExtraction/Datasets/'</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>demofolder    <span class="ot">&lt;-</span> <span class="fu">paste0</span>(parentfolder, <span class="st">'/00_RAWDATA/Demographics_all/'</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>datasets      <span class="ot">&lt;-</span> <span class="fu">paste0</span>(curfolder, <span class="st">'/datasets/'</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>models        <span class="ot">&lt;-</span> <span class="fu">paste0</span>(curfolder, <span class="st">'/models/'</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>plots         <span class="ot">&lt;-</span> <span class="fu">paste0</span>(curfolder, <span class="st">'/plots/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-in-our-data" class="level1">
<h1>Loading in our data</h1>
<p>This is the feature dataframe we will be using when having access to full data. Additionally, we will merge the feature dataframe with demographic data collected via Qualtrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_feat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(featurefolder, <span class="st">"features_df_final.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_demo <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(demofolder, <span class="st">"all_demodata.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For confirmatory analysis, we will need only 6 features - arm torque integral, arm torque peak mean, COPc integral, COPc peak mean, envelope integral and envelope peak mean from the data_feat. From data_demo, we will need only BFI and Familiarity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>featstokeep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'COPc_pospeak_mean'</span>, <span class="st">'envelope_pospeak_mean'</span>, <span class="st">'arm_moment_sum_change_pospeak_mean'</span>, <span class="st">'COPc_integral'</span>, <span class="st">'envelope_integral'</span>, <span class="st">'arm_moment_sum_change_integral'</span>, <span class="st">'correction_info'</span>, <span class="st">'concept'</span>, <span class="st">'TrialID'</span>, <span class="st">'modality'</span>, <span class="st">'expressibility'</span>, <span class="st">'answer_prev'</span>, <span class="st">'answer_prev_dist'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>demotokeep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'BFI_extra'</span>, <span class="st">'BFI_agree'</span>, <span class="st">'BFI_consc'</span>, <span class="st">'BFI_negemo'</span>, <span class="st">'BFI_open'</span>, <span class="st">'Familiarity'</span>, <span class="st">'pcn_ID'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the dataframe</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data_feat <span class="ot">&lt;-</span> data_feat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(featstokeep))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data_demo <span class="ot">&lt;-</span> data_demo <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(demotokeep))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To merge them, we will need to have column pcn_ID in data_feat too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract participant part from TrialID</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_feat <span class="ot">&lt;-</span> data_feat <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pcn_ID =</span> <span class="fu">str_extract</span>(TrialID, <span class="st">"^[0-9]+"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Extract first number (before first underscore)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"_"</span>, <span class="fu">str_extract</span>(TrialID, <span class="st">"p[0-9]+"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"p"</span>)) <span class="co"># Extract last part and format as pcn_ID</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_feat, data_demo, <span class="at">by =</span> <span class="st">"pcn_ID"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_data, <span class="at">n=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 20
   COPc_pospeak_mean envelope_pospeak_mean arm_moment_sum_change…¹ COPc_integral
               &lt;dbl&gt;                 &lt;dbl&gt;                   &lt;dbl&gt;         &lt;dbl&gt;
 1            -0.257                -0.529                  -0.29        -326.  
 2            -0.516                -0.531                  -0.545       -782.  
 3            -0.507                -0.529                   0.41        -791.  
 4            -0.052                -0.406                  -0.227          4.62
 5            -0.155                -0.419                  -0.156       -269.  
 6            -0.233                -0.513                  -0.108       -171.  
 7            -0.561                 0.338                  NA           -486.  
 8             3.50                 NA                       1.34       18163.  
 9            -0.444                -0.408                   1.00       -1092.  
10            -0.287                -0.452                  -0.047       -870.  
11             0.547                 0.137                  NA           1435.  
12            -0.441                -0.51                    0.886       -529.  
13             0.216                 0.474                   0.658       1623.  
14             0.643                 1.31                    0.61        1988.  
15            -0.361                -0.478                   1.56        -290.  
# ℹ abbreviated name: ¹​arm_moment_sum_change_pospeak_mean
# ℹ 16 more variables: envelope_integral &lt;dbl&gt;,
#   arm_moment_sum_change_integral &lt;dbl&gt;, correction_info &lt;chr&gt;, concept &lt;chr&gt;,
#   TrialID &lt;chr&gt;, modality &lt;chr&gt;, expressibility &lt;dbl&gt;, answer_prev &lt;chr&gt;,
#   answer_prev_dist &lt;dbl&gt;, pcn_ID &lt;chr&gt;, BFI_extra &lt;dbl&gt;, BFI_agree &lt;dbl&gt;,
#   BFI_consc &lt;dbl&gt;, BFI_negemo &lt;dbl&gt;, BFI_open &lt;dbl&gt;, Familiarity &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Because current pilot data are quite likely unsufficient in terms of power (65 observations), and would hinder testing the design of the statistical models, we will create synthetic data with assumed coefficients for all predictors we plan to add to the model.</p>
</section>
<section id="h1-stating-causal-model" class="level1">
<h1>H1: Stating causal model</h1>
<p>Before simulating synthetic data, we will first formulate our causal model to explicitly identify common causes, and hence prevent (or rather minimize) confounding in our statistical model. Note that while we are interested in causal relationship between effort (outcome) and communicative attempt (predictor for H1) and answer similarity (predictor for H2), we need to acknowledge that there are other factors possibly contributing to the outcome variable, despite the experiment beling relatively controlled. These relate, for instance, to the participants (e.g., personality traits) or stimuli (i.e., concepts). Our causal model therefore includes more variables that are identified as potentially sharing causal path with our primary predictor - communicative attempt. They are not of primary interest, they ensure we can isolate the causal effect of the main predictor on the outcome variable - effort.</p>
<p>To explicitly formulate the causal paths, we will start our analysis visualizing our causal model using directed acyclic graph (DAG). We will use packages <code>dagitty</code> and <code>ggdag</code> to create these DAGs and to extract implied independencies and adjustment set. DAG will help us clarify the causal model and introduce the predictors we aim to model (<span class="citation" data-cites="mcelreath18">McElreath (<a href="#ref-mcelreath18" role="doc-biblioref">2018</a>)</span>). This model goes hand in hand with the logic underlying the synthetic data we create below.</p>
<p>Our first hypothesis goes as follows:</p>
<p><em>H1: Correction recruits more physical effort than the baseline performance.</em></p>
<p>The relationship of interest is the causal effect of <em>communicative attempt</em> on <em>effort</em>. Further, our causal model includes following assumptions:</p>
<ul>
<li><p>Personality traits (measured with Big5) will influence effort (e.g., people are more willing to put more effort if they are open-minded) and also communicative attempt (e.g., more extroverted people are better in this game, therefore they need less attempts)</p></li>
<li><p>Familiarity with guessing partner influences effort (ditto) as well as communicative attempt (e.g., friends are better in this game than strangers)</p></li>
<li><p>Similarly, participant will also directly influence effort and commAtt, because personality traits might not be capturing all variation</p></li>
<li><p>Expressibility of concepts is going to influence effort (e.g., more expressible concepts allow more enhancement - but could be also other direction) as well as CommAtt (e.g., more expressible concepts are more readily guessed and don’t need more attempts)</p></li>
<li><p>Similarly, concept will also directly influence effort and commAtt, because expressibility might not be capturing all variation</p></li>
<li><p>Modality (uni vs.&nbsp;multi) will influence the value of effort. We assume that in unimodal condition, the feature does not need to account for synergic relations with the other modality, and may carry the whole signal. In multimodal condition, however, there may be synergic relations that moderate the full expressiveness of this feature</p></li>
<li><p>Trial number (characterising how far one is in the experiment) could be hinting on learning processes through out the experiment, or - the other direction - on increasing fatigue</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/dag h1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These are the implied conditional independencies</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Big5 _||_ Conc
Big5 _||_ Expr
Big5 _||_ Fam | Pcn
Big5 _||_ Mod
Big5 _||_ TrNm
Conc _||_ Fam
Conc _||_ Mod
Conc _||_ Pcn
Conc _||_ TrNm
Expr _||_ Fam
Expr _||_ Mod
Expr _||_ Pcn
Expr _||_ TrNm
Fam _||_ Mod
Fam _||_ TrNm
Mod _||_ Pcn
Mod _||_ TrNm
Pcn _||_ TrNm</code></pre>
</div>
</div>
<p>This is the adjustment set that needs to be included in the model to make sure we are not confounding</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>{ Big5, Conc, Expr, Fam, Mod, Pcn, TrNum }</code></pre>
</div>
</div>
</section>
<section id="creating-synthetic-data-for-pre-registration-purposes-only" class="level1">
<h1>Creating synthetic data (for pre-registration purposes only)</h1>
<p>Now we can proceed with creating synthetic data, incorporating the relationships we have acknowledged in our causal model. We will then use these data to validate the statistical models. We believe this approach constitutes a principled and transparent method for model validation (<span class="citation" data-cites="mcelreath18">McElreath (<a href="#ref-mcelreath18" role="doc-biblioref">2018</a>)</span>, <span class="citation" data-cites="morris_etal19">Morris, White, and Crowther (<a href="#ref-morris_etal19" role="doc-biblioref">2019</a>)</span>). By evaluating the model structure on simulated data before fitting it to empirical observations, we reduce the risk of overfitting and p-hacking, as model assumptions and inferences are tested independently of the observed data.</p>
<p>Note that the synthetic data do not copy the structure of the data and the experimental design perfectly, but they do provide a reliable ground to build the models and test their performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0209</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set coefficients</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>b_exp_vocal <span class="ot">&lt;-</span> <span class="fl">0.6</span>  <span class="co"># Vocal has lower expressibility</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>b_exp_multi <span class="ot">&lt;-</span> <span class="fl">1.5</span>  <span class="co"># Multimodal has higher expressibility</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>b_bif <span class="ot">&lt;-</span> <span class="fl">1.15</span>  <span class="co"># More extroverted → more effort</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>b_fam <span class="ot">&lt;-</span> <span class="fl">1.10</span>  <span class="co"># More familiarity → more effort</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>b_exp <span class="ot">&lt;-</span> <span class="fl">1.20</span>  <span class="co"># More expressibility → more effort</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>b_multi <span class="ot">&lt;-</span> <span class="fl">0.70</span>  <span class="co"># Multimodal → slightly reduced effort</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>b_comatt2 <span class="ot">&lt;-</span> <span class="fl">1.50</span>  <span class="co"># Effort increases for second attempt</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>b_comatt3 <span class="ot">&lt;-</span> <span class="fl">0.50</span>  <span class="co"># Effort decreases for third attempt</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>b_prevan <span class="ot">&lt;-</span> <span class="fl">0.50</span>  <span class="co"># Higher previous answer similarity → less effort</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define participants and concepts</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>n_total_concepts <span class="ot">&lt;-</span> <span class="dv">21</span>  <span class="co"># Each participant works with all 21 concepts</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>n_modalities <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Gesture, vocal, combined</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate participant-level data</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_participants</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>Big5 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_participants, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>Familiarity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_participants, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate expressibility scores for each concept across modalities</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>expressibility_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n_total_concepts <span class="sc">*</span> n_modalities, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                                <span class="at">nrow =</span> n_total_concepts, <span class="at">ncol =</span> n_modalities)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize data storage</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>final_data_synt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to simulate participant data</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>simulate_participant <span class="ot">&lt;-</span> <span class="cf">function</span>(participant_id) {</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  participant_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  trial_number <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (concept_id <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_total_concepts) {</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assign a random modality</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    modality <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"gesture"</span>, <span class="st">"vocal"</span>, <span class="st">"combined"</span>), <span class="dv">1</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get expressibility score based on modality</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    expressibility_score <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(modality <span class="sc">==</span> <span class="st">"vocal"</span>, expressibility_matrix[concept_id, <span class="dv">1</span>] <span class="sc">*</span> b_exp_vocal, </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(modality <span class="sc">==</span> <span class="st">"gesture"</span>, expressibility_matrix[concept_id, <span class="dv">2</span>], </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                                          expressibility_matrix[concept_id, <span class="dv">3</span>] <span class="sc">*</span> b_exp_multi))</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Base effort before adjustments</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    base_effort <span class="ot">&lt;-</span> b_bif <span class="sc">*</span> Big5[participant_id] <span class="sc">+</span> </span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                   b_fam <span class="sc">*</span> Familiarity[participant_id] <span class="sc">+</span> </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                   b_exp <span class="sc">*</span> expressibility_score <span class="sc">+</span> </span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust effort for multimodal condition</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (modality <span class="sc">==</span> <span class="st">"combined"</span>) {</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>      base_effort <span class="ot">&lt;-</span> base_effort <span class="sc">*</span> b_multi</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the number of communicative attempts (CommAtt)</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    adjusted_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> Familiarity[participant_id],</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> Familiarity[participant_id],</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> Familiarity[participant_id]) <span class="sc">*</span> </span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> Big5[participant_id],</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> Big5[participant_id],</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> Big5[participant_id]) <span class="sc">*</span> </span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> expressibility_score,</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> expressibility_score,</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">-</span> expressibility_score)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    adjusted_prob <span class="ot">&lt;-</span> adjusted_prob <span class="sc">/</span> <span class="fu">sum</span>(adjusted_prob)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    n_attempts <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="at">prob =</span> adjusted_prob)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    prev_answer_similarity <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># First attempt has no previous similarity</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate rows for each communicative attempt</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (attempt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_attempts) {</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>      Eff <span class="ot">&lt;-</span> base_effort  <span class="co"># Start with base effort</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Modify effort for second and third attempts</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (attempt <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>        Eff <span class="ot">&lt;-</span> Eff <span class="sc">*</span> b_comatt2</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (attempt <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>        Eff <span class="ot">&lt;-</span> Eff <span class="sc">*</span> b_comatt3</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Adjust effort based on previous answer similarity</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(prev_answer_similarity)) {</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>        Eff <span class="ot">&lt;-</span> Eff <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> prev_answer_similarity) <span class="sc">*</span> b_prevan)</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store row</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>      participant_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(participant_data, <span class="fu">data.frame</span>(</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">Participant =</span> participant_id,</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">Concept =</span> concept_id,</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">Modality =</span> modality,</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">Big5 =</span> Big5[participant_id],</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">Familiarity =</span> Familiarity[participant_id],</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">Expressibility =</span> expressibility_score,</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">CommAtt =</span> attempt,</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">Eff =</span> Eff,</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">TrialNumber =</span> trial_number,</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">PrevAn =</span> prev_answer_similarity</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Update for next attempt</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>      trial_number <span class="ot">&lt;-</span> trial_number <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>      prev_answer_similarity <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)  <span class="co"># Simulate next similarity</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(participant_data)</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for all participants</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>final_data_synt <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(participants, simulate_participant))</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview results</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_data_synt, <span class="at">n=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Participant Concept Modality     Big5 Familiarity Expressibility CommAtt
1            1       1 combined 1.919899    1.843906    0.576172309       1
2            1       1 combined 1.919899    1.843906    0.576172309       2
3            1       1 combined 1.919899    1.843906    0.576172309       3
4            1       2  gesture 1.919899    1.843906    0.349378655       1
5            1       2  gesture 1.919899    1.843906    0.349378655       2
6            1       2  gesture 1.919899    1.843906    0.349378655       3
7            1       3    vocal 1.919899    1.843906    0.339527537       1
8            1       3    vocal 1.919899    1.843906    0.339527537       2
9            1       3    vocal 1.919899    1.843906    0.339527537       3
10           1       4 combined 1.919899    1.843906    0.718778601       1
11           1       4 combined 1.919899    1.843906    0.718778601       2
12           1       5  gesture 1.919899    1.843906    0.078069667       1
13           1       6  gesture 1.919899    1.843906    0.004189679       1
14           1       6  gesture 1.919899    1.843906    0.004189679       2
15           1       6  gesture 1.919899    1.843906    0.004189679       3
         Eff TrialNumber     PrevAn
1   4.343849           1         NA
2   6.566250           2 0.98450637
3   2.367010           3 0.82035722
4   5.497853           4         NA
5  10.367605           5 0.48565959
6   3.998448           6 0.09090184
7   6.153093           7         NA
8  12.934986           8 0.19707656
9   3.593379           9 0.66401787
10  4.094773          10         NA
11  6.406363          11 0.91397050
12  5.275766          12         NA
13  5.605587          13         NA
14 12.021459          14 0.14060042
15  3.439740          15 0.54549131</code></pre>
</div>
</div>
</section>
<section id="exploring-the-synthetic-data" class="level1">
<h1>Exploring the synthetic data</h1>
<p>This is the distribution of our simulated effort feature</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/effort hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is the relationship between effort and communicative attempt (H1) as seen in the raw (synthetic) data</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1 raw plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="h1-modelling" class="level1">
<h1>H1: Modelling</h1>
<p>In this part, we are going to test the following hypothesis:</p>
<p><em>H1: Correction recruits more physical effort than the baseline performance.</em></p>
<p>We will fit Bayesian mixed effect models using <code>brms</code> package (<span class="citation" data-cites="burkner17">Bürkner (<a href="#ref-burkner17" role="doc-biblioref">2017</a>)</span>)</p>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data wrangling</h2>
<p>To be able to interpret the data, we will first need to do some data wrangling</p>
<p>Convert columns to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final_data<span class="sc">$</span>CommAtt)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Modality <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final_data<span class="sc">$</span>Modality)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Participant <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final_data<span class="sc">$</span>Participant)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Concept <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final_data<span class="sc">$</span>Concept)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>TrialNumber <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(final_data<span class="sc">$</span>TrialNumber)  <span class="co"># Ensure TrialNumber is numeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrast-coding of categorical variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(final_data<span class="sc">$</span>CommAtt) <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">contr.sdif</span>(<span class="dv">3</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(final_data<span class="sc">$</span>Modality) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is how CommAtt is contrast-coded now</p>
<p>2-1 3-2</p>
<p>1 -0.6666667 -0.3333333 2 0.3333333 -0.3333333 3 0.3333333 0.6666667</p>
<p>This is how modality is cc-ed</p>
<p>[,1] [,2]</p>
<p>combined 0.5 0.0 gesture 0.0 0.5 vocal -0.5 -0.5</p>
</div>
</div>
<p>Centering continuous variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>TrialNumber_c <span class="ot">&lt;-</span> final_data<span class="sc">$</span>TrialNumber <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(final_data<span class="sc">$</span>TrialNumber))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Familiarity <span class="ot">&lt;-</span> final_data<span class="sc">$</span>Familiarity <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(final_data<span class="sc">$</span>Familiarity))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>Big5 <span class="ot">&lt;-</span> final_data<span class="sc">$</span>Big5 <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(final_data<span class="sc">$</span>Big5))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For now, we will just center Familiarity and Big5 because we created them synthetically. But the real data have these two variables already z-scored</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Z-scoring expressibility within a modality</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  final_data <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Modality) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expressibility_z =</span> (Expressibility <span class="sc">-</span> <span class="fu">mean</span>(Expressibility))<span class="sc">/</span> <span class="fu">sd</span>(final_data<span class="sc">$</span>Expressibility, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-1---simple-reproduction-of-dag" class="level2">
<h2 class="anchored" data-anchor-id="model-1---simple-reproduction-of-dag">Model 1 - Simple reproduction of DAG</h2>
<p>First we want to do a simple model that reproduce our DAG.</p>
<p>Our main predictor is communicative attempt (CommAtt). To account for confounders - variables affecting both the predictor and the dependent variable - we need to adjust for them in the model by including them as covariates to isolate the effect of the predictor. Based on our DAG, confounders include:</p>
<ol type="1">
<li>familiarity</li>
<li>big5</li>
<li>expressibility</li>
<li>trial number</li>
<li>modality</li>
<li>concept</li>
<li>participant</li>
</ol>
<p>We include 1.-5. as fixed factors. For 6.-7., we include varying intercepts as we expect that each participant and concept may have they own baseline level of effort and thus allow for individual variation. Partial pooling is also beneficial in that extreme values (or categories will fewer datapoints) will be shrunk toward the overal average.</p>
<p>We will now not include PrevAn (previous answer) variable because we will need to do some further data-wrangling when building model for H2. That is mainly because PrevAn has some NA values, concretely for first attempts. Models would automatically exclude NA data, and we would therefore loose all effort data for attempt 1. For H1, however, we want to keep it there.</p>
<p>This is our first model without setting any priors, leaving them to default values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>h1.m1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Familiarity <span class="sc">+</span> Big5 <span class="sc">+</span> Expressibility_z <span class="sc">+</span> TrialNumber_c <span class="sc">+</span> Modality <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Concept),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>h1.m1 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m1, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>h1.m1_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m1)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m1, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m1.rds"</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m1_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m1_R2.rds"</span>))</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>h1.m1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m1.rds"</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>h1.m1_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m1_R2.rds"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Familiarity + Big5 + Expressibility_z + TrialNumber_c + Modality + (1 | Participant) + (1 | Concept) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.04      0.02     0.00     0.09 1.00     2122     1863

~Participant (Number of levels: 120) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.03      0.02     0.00     0.07 1.00     2320     3475

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            4.02      0.02     3.98     4.06 1.00     6694     5622
CommAtt2M1           3.08      0.03     3.03     3.14 1.00     8963     6147
CommAtt3M2          -4.39      0.04    -4.46    -4.32 1.00     8289     5880
Familiarity          1.26      0.02     1.21     1.30 1.00     8380     5226
Big5                 1.29      0.02     1.25     1.34 1.00     9979     6018
Expressibility_z     0.46      0.02     0.43     0.49 1.00     9888     5989
TrialNumber_c       -0.00      0.00    -0.00     0.00 1.00     7595     5984
Modality1           -1.30      0.04    -1.38    -1.23 1.00     8559     5997
Modality2            0.64      0.04     0.57     0.71 1.00     7347     5787

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.91      0.01     0.89     0.93 1.00    11791     5667

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note on modality: Modality1 represents the baseline difference between combined and the other modalities, and Modality2 represents the difference between gesture and vocal compared to combined.</p>
</div>
</div>
<section id="transforming-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="transforming-coefficients">Transforming coefficients</h3>
<p>To be able to link these estimates back to the simulation coefficients, let’s create a function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>transform_attempt <span class="ot">&lt;-</span> <span class="cf">function</span>(intercept, CommAtt2M1, CommAtt3M2) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effort for the first attempt (base effort)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  Eff_attempt_1 <span class="ot">&lt;-</span> intercept</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effort for the second attempt</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  Eff_attempt_2 <span class="ot">&lt;-</span> Eff_attempt_1 <span class="sc">+</span> CommAtt2M1</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effort for the third attempt</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  Eff_attempt_3 <span class="ot">&lt;-</span> Eff_attempt_1 <span class="sc">+</span> CommAtt2M1 <span class="sc">+</span> CommAtt3M2</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate ratios</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  b_attempt2 <span class="ot">&lt;-</span> Eff_attempt_2 <span class="sc">/</span> Eff_attempt_1</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  b_attempt3 <span class="ot">&lt;-</span> Eff_attempt_3 <span class="sc">/</span> Eff_attempt_2</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(b_attempt2, b_attempt3))</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>h1m1_coeff <span class="ot">&lt;-</span> <span class="fu">transform_attempt</span>(<span class="fl">4.02</span>, <span class="fl">3.08</span>, <span class="sc">-</span><span class="fl">4.39</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(h1m1_coeff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b_attempt2 b_attempt3
1   1.766169  0.3816901</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For centered familiarity</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fam <span class="ot">=</span> (<span class="fl">4.02</span> <span class="sc">+</span> <span class="fl">1.26</span>) <span class="sc">/</span> <span class="fl">4.02</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.313433</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For centered BIF</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>bif <span class="ot">=</span> (<span class="fl">4.02</span> <span class="sc">+</span> <span class="fl">1.29</span>) <span class="sc">/</span> <span class="fl">4.02</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.320896</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Expressibility is z-scored so we will not get to the coefficient in the same way but we can check the conditinal effects for checking whether it looks good</p>
</div>
</div>
<p>Let’s also check the visuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all caterpillars look nice</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m1), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m1, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good but not amazing - mostly because the posteriors seem to not know effort cannot be negative</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m1, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m1 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># half blobby, half correlated, so still some room for improvement</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># positive correlation means that errors increase with predicted values. So the model does perform well for some range, but becomes less reliable with increase in the predicted values</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># also the blob is centered around 0 which is good</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># it could be we are ignoring some interaction terms or non-linearity (which we know we kind of do). Transformation could also help (e.g., log). Of course, we are also still not specifying any priors so let's not yet make it a disaster</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>h1.m1_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5     Q97.5
R2 0.8381496 0.001662319 0.8348364 0.8412852</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance around 83%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Overall, we see good directions of all predictors, mostly also in accordance with the expected coefficients. Of course, the synthetic data is quite complex so there might be other dependencies that moderate the causal relationships and that is why we do not see exactly the numbers we use to create the data.</p>
<p>Let’s have another model for comparison.</p>
<p>We can assume that participants and concept have not only different baselines of effort (varying intercept). The effect of CommAtt on effort might vary across them too, hence we can try to add varying slopes for them and see whether the diagnostics improves. We will also add TrialNumber as a varying intercept, because we expect variation between earlier and later performances (because of learning, or opposite, fatigue).</p>
</section>
</section>
<section id="model-2---varying-slopes-and-intercepts" class="level2">
<h2 class="anchored" data-anchor-id="model-2---varying-slopes-and-intercepts">Model 2 - Varying slopes and intercepts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>h1.m2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> TrialNumber_c), </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>h1.m2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m2, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>h1.m2_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m2)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m2.rds"</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m2_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m2_R2.rds"</span>))</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>h1.m2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m2.rds"</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>h1.m2_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m2_R2.rds"</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt | Participant) + (1 + CommAtt | Concept) + (1 | TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.06      0.02     0.02     0.10 1.00     2791
sd(CommAtt2M1)                 0.17      0.04     0.11     0.26 1.00     3239
sd(CommAtt3M2)                 0.25      0.06     0.16     0.37 1.00     3386
cor(Intercept,CommAtt2M1)      0.52      0.28    -0.14     0.93 1.00     1312
cor(Intercept,CommAtt3M2)     -0.35      0.32    -0.90     0.32 1.00     1261
cor(CommAtt2M1,CommAtt3M2)    -0.93      0.07    -1.00    -0.75 1.00     5691
                           Tail_ESS
sd(Intercept)                  2048
sd(CommAtt2M1)                 4832
sd(CommAtt3M2)                 5133
cor(Intercept,CommAtt2M1)      1617
cor(Intercept,CommAtt3M2)      1450
cor(CommAtt2M1,CommAtt3M2)     6716

~Participant (Number of levels: 120) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.15      0.04     0.08     0.22 1.00      901
sd(CommAtt2M1)                 0.78      0.06     0.68     0.90 1.00     2066
sd(CommAtt3M2)                 1.10      0.08     0.95     1.27 1.00     2076
cor(Intercept,CommAtt2M1)      0.96      0.03     0.87     1.00 1.01      352
cor(Intercept,CommAtt3M2)     -0.96      0.04    -1.00    -0.85 1.01      353
cor(CommAtt2M1,CommAtt3M2)    -1.00      0.00    -1.00    -0.99 1.00     7139
                           Tail_ESS
sd(Intercept)                  2511
sd(CommAtt2M1)                 3409
sd(CommAtt3M2)                 3623
cor(Intercept,CommAtt2M1)       596
cor(Intercept,CommAtt3M2)       690
cor(CommAtt2M1,CommAtt3M2)     6841

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.02      0.02     0.00     0.06 1.00     3119     3942

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            4.03      0.02     3.99     4.08 1.00     2093     3494
CommAtt2M1           3.07      0.08     2.90     3.23 1.00     1384     2570
CommAtt3M2          -4.36      0.12    -4.59    -4.13 1.00     1411     2477
Modality1           -1.29      0.03    -1.35    -1.23 1.00     8986     6966
Modality2            0.64      0.03     0.58     0.71 1.00     9767     6458
Big5                 1.08      0.05     0.99     1.16 1.01      854     2264
Familiarity          1.04      0.05     0.94     1.12 1.00      957     2173
Expressibility_z     0.44      0.02     0.41     0.47 1.00     5445     5281

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.80      0.01     0.78     0.81 1.00    11536     6199

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged but there were some divergent transitions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># some some of the caterpillars are not that pretty anymore</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m2), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m2, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks good but not amazing - mostly because the posteriors seem to not know effort cannot be negative</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m2, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m2 check-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This looks a bit more blobby than before but still lots of errors for higher values</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>h1.m2_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate  Est.Error      Q2.5     Q97.5
R2 0.8760573 0.00125936 0.8734939 0.8784314</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance around 87%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One of the reasons why we might be getting the divergent transition is because of the correlation between slopes and intercepts in the previous model. Let’s now get rid of it</p>
</section>
<section id="model-3---no-correlation-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="model-3---no-correlation-coefficient">Model 3 - No correlation coefficient</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>h1.m3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">||</span> TrialNumber_c), </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>h1.m3 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m3, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>h1.m3_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m3)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m3, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3.rds"</span>))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m3_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3_R2.rds"</span>))</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>h1.m3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3.rds"</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>h1.m3_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3_R2.rds"</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt || Participant) + (1 + CommAtt || Concept) + (1 || TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.05      0.02     0.01     0.10 1.00     2648     2360
sd(CommAtt2M1)     0.09      0.05     0.01     0.19 1.01     1159     1540
sd(CommAtt3M2)     0.17      0.06     0.04     0.30 1.00     1422     1517

~Participant (Number of levels: 120) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.03      0.02     0.00     0.08 1.00     2442     4123
sd(CommAtt2M1)     0.71      0.05     0.61     0.82 1.00     2733     4516
sd(CommAtt3M2)     1.05      0.08     0.91     1.21 1.00     2231     3994

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.02      0.02     0.00     0.06 1.00     3301     3712

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            4.03      0.02     3.99     4.06 1.00     9303     6039
CommAtt2M1           3.07      0.07     2.93     3.22 1.00     2152     3434
CommAtt3M2          -4.36      0.11    -4.58    -4.15 1.00     2100     3982
Modality1           -1.30      0.03    -1.36    -1.24 1.00    11936     6326
Modality2            0.65      0.03     0.58     0.71 1.00    12551     6401
Big5                 1.23      0.02     1.19     1.28 1.00    15911     6657
Familiarity          1.20      0.02     1.15     1.24 1.00    14065     6574
Expressibility_z     0.45      0.01     0.42     0.48 1.00    14842     5619

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.81      0.01     0.80     0.83 1.00    11557     5519

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no correlation fixed the performance</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m3), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m3, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the problem with predicting negative values remains</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m3, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>h1.m3_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5    Q97.5
R2 0.8714492 0.001445024 0.8685275 0.874215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 87%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-3.1---adding-priors" class="level2">
<h2 class="anchored" data-anchor-id="model-3.1---adding-priors">Model 3.1 - adding priors</h2>
<p>Now we will add some minimal priors, giving the model some reasonably informative, yet weak information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>priors_h1m3p <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(2.5, 0.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">lb=</span><span class="dv">0</span>),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt2M1"</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt3M2"</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality1"</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality2"</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Big5"</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Familiarity"</span>),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Expressibility_z"</span>),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"TrialNumber_c"</span>),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Participant"</span>),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Concept"</span>),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(1,0.1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.25)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>h1.m3p <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">||</span> TrialNumber_c), </span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior=</span>priors_h1m3p,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> gaussian,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>h1.m3p <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m3p, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>h1.m3p_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m3p)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m3p, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3p.rds"</span>))</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m3p_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3p_R2.rds"</span>))</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>h1.m3p <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3p.rds"</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>h1.m3p_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m3p_R2.rds"</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m3p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt || Participant) + (1 + CommAtt || Concept) + (1 || TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.08      0.03     0.03     0.14 1.00     2732     4188
sd(CommAtt2M1)     0.22      0.06     0.12     0.36 1.00     2853     4652
sd(CommAtt3M2)     0.34      0.08     0.20     0.51 1.00     2590     5063

~Participant (Number of levels: 120) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.06      0.02     0.01     0.10 1.00     2220     2200
sd(CommAtt2M1)     0.66      0.04     0.58     0.75 1.00     4131     5851
sd(CommAtt3M2)     0.89      0.05     0.80     0.98 1.00     4638     6332

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.04      0.02     0.00     0.08 1.00     2687     3691

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            4.02      0.02     3.97     4.07 1.00     8469     6434
CommAtt2M1           2.99      0.08     2.83     3.15 1.00     2795     4372
CommAtt3M2          -4.12      0.12    -4.35    -3.87 1.00     2401     3679
Modality1           -1.27      0.03    -1.34    -1.21 1.00    13767     6673
Modality2            0.63      0.03     0.56     0.69 1.00    13131     6444
Big5                 1.23      0.02     1.18     1.28 1.00    12639     6019
Familiarity          1.19      0.03     1.14     1.24 1.00    13068     6412
Expressibility_z     0.45      0.02     0.42     0.48 1.00    15210     5985

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.81      0.01     0.80     0.83 1.00    14125     5732

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m3p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m3p), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m3p, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the problem with predicting negative values remains</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m3p, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m3p check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>h1.m3p_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5    Q97.5
R2 0.8705705 0.001478901 0.8676255 0.873398</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 87%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-4---restricting-priors-with-exponential-distribution" class="level2">
<h2 class="anchored" data-anchor-id="model-4---restricting-priors-with-exponential-distribution">Model 4 - Restricting priors with exponential distribution</h2>
<p>Let’s do one more test with the priors, restricting sd them with exponential distribution, i.e., negative values are not possible</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>priors_h1m4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(3, 0.3)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">lb =</span> <span class="dv">0</span>),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt2M1"</span>),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt3M2"</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.15)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality1"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.15)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality2"</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.15)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Big5"</span>),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.15)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Familiarity"</span>),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0, 0.15)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Expressibility_z"</span>),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exponential priors for standard deviations</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"exponential(3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"TrialNumber_c"</span>), <span class="co"># exp(3) has a mean of 1/3 and concentrates most density around small values</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"exponential(3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Participant"</span>),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"exponential(3)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Concept"</span>),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"exponential(1)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>),  <span class="co"># Generic sd prior</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Residual standard deviation - keep it narrow</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5, 0.1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>h1.m4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">||</span> TrialNumber_c), </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior=</span>priors_h1m4,</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> gaussian,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>h1.m4 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m4, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>h1.m4_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m4)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m4, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m4.rds"</span>))</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m4_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m4_R2.rds"</span>))</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>h1.m4 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m4.rds"</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>h1.m4_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m4_R2.rds"</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt || Participant) + (1 + CommAtt || Concept) + (1 || TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.05      0.02     0.01     0.09 1.00     2376     2462
sd(CommAtt2M1)     1.98      0.37     1.33     2.78 1.00     1362     2663
sd(CommAtt3M2)     3.36      0.46     2.56     4.38 1.00      942     2031

~Participant (Number of levels: 120) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.03      0.02     0.00     0.08 1.00     2217     4211
sd(CommAtt2M1)     0.71      0.05     0.61     0.82 1.00     2746     4486
sd(CommAtt3M2)     1.05      0.08     0.92     1.22 1.00     2446     4360

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.02      0.02     0.00     0.06 1.00     3383     3814

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            4.02      0.02     3.99     4.06 1.00     9553     6582
CommAtt2M1           0.88      0.30     0.31     1.47 1.00     4070     5104
CommAtt3M2          -0.36      0.26    -0.87     0.14 1.00    10008     6008
Modality1           -1.23      0.03    -1.29    -1.16 1.00    14208     6281
Modality2            0.59      0.03     0.53     0.65 1.00    15010     6334
Big5                 1.21      0.02     1.16     1.25 1.00    13972     6575
Familiarity          1.17      0.02     1.12     1.21 1.00    13947     5839
Expressibility_z     0.44      0.01     0.41     0.47 1.00    17170     6516

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.81      0.01     0.79     0.83 1.00    15722     5841

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the coefficients for commatt now seem much lower</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>h1m1_coeff <span class="ot">&lt;-</span> <span class="fu">transform_attempt</span>(<span class="fl">4.02</span>, <span class="fl">0.88</span>, <span class="sc">-</span><span class="fl">0.36</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(h1m1_coeff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b_attempt2 b_attempt3
1   1.218905  0.9265306</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For centered familiarity</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fam <span class="ot">=</span> (<span class="fl">4.02</span> <span class="sc">+</span> <span class="fl">1.17</span>) <span class="sc">/</span> <span class="fl">4.02</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.291045</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For centered BIF</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>bif <span class="ot">=</span> (<span class="fl">4.02</span> <span class="sc">+</span> <span class="fl">1.21</span>) <span class="sc">/</span> <span class="fl">4.02</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.300995</code></pre>
</div>
</div>
<p>So it seems that we are misleading with the priors and this will not be the way</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m4), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effect of main predictor is now very moderated </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m4, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the problem with predicting negative values remains</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m4, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m4 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>h1.m4_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error     Q2.5    Q97.5
R2 0.8701813 0.001472199 0.867155 0.872996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 87%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-5---student-family" class="level2">
<h2 class="anchored" data-anchor-id="model-5---student-family">Model 5 - student family</h2>
<p>We still see negative values in the posterior simulations, so let’s try Student’s t-distribution which is more robust to outliers and can potentially reduce the likelihood of negative values (if we reduce degrees of freedom)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>priors_h1m5 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(2.5, 0.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">lb=</span><span class="dv">0</span>),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt2M1"</span>),</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt3M2"</span>),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality1"</span>),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality2"</span>),</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Big5"</span>),</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Familiarity"</span>),</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Expressibility_z"</span>),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.05)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"TrialNumber_c"</span>),</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.05)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Participant"</span>),</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.05)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"Concept"</span>),</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(1,0.05)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0.5,0.1)"</span>, <span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"gamma(2, 0.1)"</span>, <span class="at">class =</span> <span class="st">"nu"</span>)  <span class="co"># Prior for degrees of freedom</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>h1.m5 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">||</span> TrialNumber_c), </span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior=</span>priors_h1m5,</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> student,</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>h1.m5 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m5, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>h1.m5_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m5)</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m5, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m5.rds"</span>))</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m5_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m5_R2.rds"</span>))</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>h1.m5 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m5.rds"</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>h1.m5_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m5_R2.rds"</span>))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: student 
  Links: mu = identity; sigma = identity; nu = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt || Participant) + (1 + CommAtt || Concept) + (1 || TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.38      0.06     0.26     0.49 1.00     5974     5242
sd(CommAtt2M1)     0.42      0.05     0.32     0.53 1.00     8447     6363
sd(CommAtt3M2)     0.46      0.05     0.36     0.56 1.00     8880     6408

~Participant (Number of levels: 120) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.13      0.02     0.10     0.17 1.00     3617     5313
sd(CommAtt2M1)     0.57      0.03     0.51     0.63 1.00     6105     6010
sd(CommAtt3M2)     0.72      0.03     0.66     0.79 1.00     7296     6471

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.09      0.03     0.04     0.15 1.00     1649     2746

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            3.92      0.08     3.75     4.08 1.00     1736     3195
CommAtt2M1           2.78      0.11     2.56     2.99 1.00     2927     3842
CommAtt3M2          -3.95      0.13    -4.19    -3.70 1.00     2998     3937
Modality1           -1.11      0.03    -1.17    -1.06 1.00    13750     6634
Modality2            0.56      0.03     0.51     0.62 1.00    15623     6248
Big5                 1.15      0.03     1.10     1.21 1.00    10082     6655
Familiarity          1.13      0.03     1.07     1.18 1.00     9422     6474
Expressibility_z     0.39      0.01     0.36     0.41 1.00    16992     6093

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.52      0.01     0.50     0.55 1.00    11160     6372
nu        2.96      0.16     2.67     3.28 1.00    13245     5813

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the coefficients look ok again. Familiarity and Big5 even got closer to our simulated betas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m5), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m5, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the fit seems somewhat better than with gaussian, but still negative values are there</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m5, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m5 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>h1.m5_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error    Q2.5     Q97.5
R2 0.8541097 0.002443239 0.84921 0.8587499</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 85%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-6---log-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="model-6---log-normal-distribution">Model 6 - log-normal distribution</h2>
<p>We have already seen - when plotting - that effort probably tends towards lognormal distribution. We will keep the model constant, just exchange the distribution. Priors are kept default</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>h1.m6 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">||</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">||</span> TrialNumber_c), </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>h1.m6 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m6, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>h1.m6_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m6)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m6, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6.rds"</span>))</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m6_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6_R2.rds"</span>))</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>h1.m6 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6.rds"</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>h1.m6_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6_R2.rds"</span>))</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt || Participant) + (1 + CommAtt || Concept) + (1 || TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.01      0.00     0.00     0.02 1.00     2298     2414
sd(CommAtt2M1)     0.00      0.00     0.00     0.01 1.00     4803     3682
sd(CommAtt3M2)     0.01      0.01     0.00     0.02 1.00     3687     3650

~Participant (Number of levels: 120) 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)      0.05      0.00     0.04     0.06 1.00     2844     4508
sd(CommAtt2M1)     0.00      0.00     0.00     0.01 1.00     4417     3655
sd(CommAtt3M2)     0.01      0.01     0.00     0.03 1.00     2618     2888

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.01 1.00     3411     3578

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.23      0.01     1.22     1.24 1.00     3120     4439
CommAtt2M1           0.62      0.01     0.61     0.63 1.00     9634     6358
CommAtt3M2          -1.10      0.01    -1.11    -1.08 1.00     9514     5588
Modality1           -0.31      0.01    -0.33    -0.30 1.00     9097     6088
Modality2            0.16      0.01     0.15     0.17 1.00     9223     6512
Big5                 0.32      0.01     0.31     0.34 1.00     2924     4558
Familiarity          0.32      0.01     0.31     0.34 1.00     2297     3545
Expressibility_z     0.12      0.00     0.12     0.13 1.00    10923     6710

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.17      0.00     0.17     0.18 1.00    11348     5998

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="converting-to-original-scale" class="level3">
<h3 class="anchored" data-anchor-id="converting-to-original-scale">Converting to original scale</h3>
<p>Of course now we have all on lognormal scale so it is not so straightforwadly interpretable. This is how we can get to the values of an effort under certain value of a predictor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute estimated marginal means on log-scale</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>em_h1.m6 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(h1.m6, <span class="sc">~</span> CommAtt) <span class="co">#~ CommAtt</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Backtransform the post.beta values</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>em_h1.m6<span class="sc">@</span>post.beta <span class="ot">&lt;-</span> <span class="fu">exp</span>(em_h1.m6<span class="sc">@</span>post.beta)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(em_h1.m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> CommAtt emmean lower.HPD upper.HPD
 1         3.33      3.29      3.37
 2         6.21      6.13      6.29
 3         2.08      2.05      2.11

Results are averaged over the levels of: Modality 
Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
</div>
<p>So we indeed see that effort in CommAtt2 increase but then decreases again for CommAtt3. We can also try to get our simulated betas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>coeff1 <span class="ot">&lt;-</span> <span class="fl">3.33</span><span class="sc">*</span><span class="fl">1.5</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>coeff2 <span class="ot">&lt;-</span> <span class="fl">3.33</span><span class="sc">*</span><span class="fl">0.5</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coeff1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.995</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coeff2) <span class="co"># which is very close to the mean values we see from the model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.665</code></pre>
</div>
</div>
<p>We see that the effect estimated by the model is now stronger than in our simulated data. However, note that these values are averaged over predictor modality</p>
<p>We can also try a different method to get the coefficients (code adapted from <a href="https://bruno.nicenboim.me/bayescogsci/ch-reg.html#sec-trial">here</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>alpha_samples <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(h1.m6)<span class="sc">$</span>b_Intercept</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>beta_2_vs_1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(h1.m6)<span class="sc">$</span>b_CommAtt2M1</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>beta_3_vs_2 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(h1.m6)<span class="sc">$</span>b_CommAtt3M2</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute expected values on the log scale</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>mu_1 <span class="ot">&lt;-</span> alpha_samples  <span class="co"># CommAtt 1</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>mu_2 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_2_vs_1  <span class="co"># CommAtt 2</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>mu_3 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_2_vs_1 <span class="sc">+</span> beta_3_vs_2  <span class="co"># CommAtt 3</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to original scale</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>effect_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(mu_1)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>effect_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(mu_2)</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>effect_3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(mu_3)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate contrasts on the original scale</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>effect_diff_2_vs_1 <span class="ot">&lt;-</span> effect_2 <span class="sc">-</span> effect_1</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>effect_diff_3_vs_2 <span class="ot">&lt;-</span> effect_3 <span class="sc">-</span> effect_2</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>effect_diff_3_vs_1 <span class="ot">&lt;-</span> effect_3 <span class="sc">-</span> effect_1</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the effects</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_intercept =</span> <span class="fu">mean</span>(effect_1),</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_diff_2_vs_1 =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(effect_diff_2_vs_1), <span class="fu">quantile</span>(effect_diff_2_vs_1, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))),</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_diff_3_vs_2 =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(effect_diff_3_vs_2), <span class="fu">quantile</span>(effect_diff_3_vs_2, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))),</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_diff_3_vs_1 =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(effect_diff_3_vs_1), <span class="fu">quantile</span>(effect_diff_3_vs_1, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mean_intercept
[1] 3.419549

$mean_diff_2_vs_1
    mean     2.5%    97.5% 
2.950688 2.872812 3.029410 

$mean_diff_3_vs_2
     mean      2.5%     97.5% 
-4.240333 -4.321665 -4.160104 

$mean_diff_3_vs_1
     mean      2.5%     97.5% 
-1.289646 -1.320918 -1.257698 </code></pre>
</div>
</div>
<p>Now we can use these coefficients to transform to our simulated betas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>h1m6_coeff <span class="ot">&lt;-</span> <span class="fu">transform_attempt</span>(<span class="fl">3.419549</span>, <span class="fl">2.950688</span>, <span class="sc">-</span><span class="fl">4.240333</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(h1m6_coeff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b_attempt2 b_attempt3
1   1.862888  0.3343524</code></pre>
</div>
</div>
<p>Now this looks closer again to our betas.</p>
<p>This code does the same for all predictors (except concept and participant)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>posterior_samples <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(h1.m6)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>alpha_samples <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Intercept</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list to store effects for each fixed factor</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>effect_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to calculate summary statistics</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>get_effect_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(effect_samples) {</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  mean_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(effect_samples)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  se_effect <span class="ot">&lt;-</span> <span class="fu">sd</span>(effect_samples)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  ci_effect <span class="ot">&lt;-</span> <span class="fu">quantile</span>(effect_samples, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  post_prob <span class="ot">&lt;-</span> <span class="fu">mean</span>(effect_samples <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">mean =</span> mean_effect, </span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> se_effect, </span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_ci =</span> ci_effect[<span class="dv">1</span>], </span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_ci =</span> ci_effect[<span class="dv">2</span>], </span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">post_prob =</span> post_prob)</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co"># COMMATT (successive differences coding)</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_CommAtt2M1"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples) <span class="sc">&amp;</span> <span class="st">"b_CommAtt3M2"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  beta_2_vs_1 <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_CommAtt2M1</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  beta_3_vs_2 <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_CommAtt3M2</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  mu_1 <span class="ot">&lt;-</span> alpha_samples</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  mu_2 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_2_vs_1</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>  mu_3 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_2_vs_1 <span class="sc">+</span> beta_3_vs_2</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"commat 2 vs 1"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_2) <span class="sc">-</span> <span class="fu">exp</span>(mu_1)),</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"commat 3 vs 2"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_3) <span class="sc">-</span> <span class="fu">exp</span>(mu_2)),</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"commat 3 vs 1"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_3) <span class="sc">-</span> <span class="fu">exp</span>(mu_1))</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co"># MODALITY (sum contrasts scaled by 0.5)</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_Modality1"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples) <span class="sc">&amp;</span> <span class="st">"b_Modality2"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  beta_mod_1 <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Modality1</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>  beta_mod_2 <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Modality2</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>  mu_mod_1 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_mod_1</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>  mu_mod_2 <span class="ot">&lt;-</span> alpha_samples <span class="sc">+</span> beta_mod_2</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>  mu_mod_3 <span class="ot">&lt;-</span> alpha_samples <span class="sc">-</span> beta_mod_1 <span class="sc">-</span> beta_mod_2</span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>Modality <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mod 1 vs 2"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_mod_1) <span class="sc">-</span> <span class="fu">exp</span>(mu_mod_2)),</span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mod 1 vs 3"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_mod_1) <span class="sc">-</span> <span class="fu">exp</span>(mu_mod_3)),</span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mod 2 vs 3"</span> <span class="ot">=</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(mu_mod_2) <span class="sc">-</span> <span class="fu">exp</span>(mu_mod_3))</span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a><span class="co"># BIG5 (continuous)</span></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_Big5"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>  beta_big5 <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Big5</span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>Big5 <span class="ot">&lt;-</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(alpha_samples <span class="sc">+</span> beta_big5) <span class="sc">-</span> <span class="fu">exp</span>(alpha_samples))</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a><span class="co"># FAMILIARITY (continuous)</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_Familiarity"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>  beta_fam <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Familiarity</span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>Familiarity <span class="ot">&lt;-</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(alpha_samples <span class="sc">+</span> beta_fam) <span class="sc">-</span> <span class="fu">exp</span>(alpha_samples))</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a><span class="co"># EXPRESSIBILITY_Z (continuous)</span></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_Expressibility_z"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a>  beta_expr <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_Expressibility_z</span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>Expressibility_z <span class="ot">&lt;-</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(alpha_samples <span class="sc">+</span> beta_expr) <span class="sc">-</span> <span class="fu">exp</span>(alpha_samples))</span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a><span class="co"># TRIAL NUMBER (centered continuous)</span></span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"b_TrialNumber_c"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(posterior_samples)) {</span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a>  beta_trial <span class="ot">&lt;-</span> posterior_samples<span class="sc">$</span>b_TrialNumber_c</span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a>  effect_list<span class="sc">$</span>TrialNumber_c <span class="ot">&lt;-</span> <span class="fu">get_effect_summary</span>(<span class="fu">exp</span>(alpha_samples <span class="sc">+</span> beta_trial) <span class="sc">-</span> <span class="fu">exp</span>(alpha_samples))</span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a nicely formatted data frame</span></span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a>effect_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, effect_list)</span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a><span class="co"># View effects</span></span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a>effect_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        mean         se lower_ci.2.5% upper_ci.97.5% post_prob
commat 2 vs 1     2.95068779 0.04052085    2.87281233      3.0294096   1.00000
commat 3 vs 2    -4.24033346 0.04140812   -4.32166524     -4.1601045   0.00000
commat 3 vs 1    -1.28964568 0.01620638   -1.32091801     -1.2576981   0.00000
mod 1 vs 2       -1.52303929 0.04030161   -1.60299691     -1.4435554   0.00000
mod 1 vs 3       -1.49131528 0.04098655   -1.57288685     -1.4107477   0.00000
mod 2 vs 3        0.03172401 0.04858764   -0.06380552      0.1252410   0.74175
Big5              1.31309529 0.04264827    1.23007768      1.3970338   1.00000
Familiarity       1.30972571 0.04408809    1.22420946      1.3983930   1.00000
Expressibility_z  0.44448503 0.01197175    0.42135330      0.4684496   1.00000</code></pre>
</div>
</div>
<p>So here we also see the negative effect of combined modality (mod1)</p>
<p>Now we can also check some visual diagnostics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m6), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m6, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we got rid of negative predictions, and it looks very good</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m6, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># very nice blob</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>h1.m6_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate  Est.Error      Q2.5     Q97.5
R2 0.8889641 0.00137284 0.8861744 0.8915303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance increases to 88%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-6.1---with-correlation" class="level2">
<h2 class="anchored" data-anchor-id="model-6.1---with-correlation">Model 6.1 - with correlation</h2>
<p>Since we now significantly improved the model performance, let’s try once again the correlation between slope and intercept</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>h1.m6c <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> TrialNumber_c), </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>h1.m6c <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m6c, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>h1.m6c_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m6c)</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m6c, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6c.rds"</span>))</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m6c_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6c_R2.rds"</span>))</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>h1.m6c <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6c.rds"</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>h1.m6c_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m6c_R2.rds"</span>))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m6c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt | Participant) + (1 + CommAtt | Concept) + (1 | TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.01      0.00     0.00     0.02 1.00     1744
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5613
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     3784
cor(Intercept,CommAtt2M1)      0.28      0.49    -0.78     0.95 1.00    11362
cor(Intercept,CommAtt3M2)      0.33      0.47    -0.75     0.95 1.00     7628
cor(CommAtt2M1,CommAtt3M2)    -0.05      0.50    -0.89     0.87 1.00     8530
                           Tail_ESS
sd(Intercept)                  1448
sd(CommAtt2M1)                 5243
sd(CommAtt3M2)                 4533
cor(Intercept,CommAtt2M1)      5945
cor(Intercept,CommAtt3M2)      5887
cor(CommAtt2M1,CommAtt3M2)     6522

~Participant (Number of levels: 120) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.05      0.00     0.04     0.06 1.00     3640
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5290
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     3474
cor(Intercept,CommAtt2M1)      0.35      0.46    -0.73     0.95 1.00    10725
cor(Intercept,CommAtt3M2)     -0.40      0.40    -0.94     0.59 1.00     9703
cor(CommAtt2M1,CommAtt3M2)    -0.27      0.49    -0.94     0.78 1.00     5410
                           Tail_ESS
sd(Intercept)                  5384
sd(CommAtt2M1)                 4470
sd(CommAtt3M2)                 4069
cor(Intercept,CommAtt2M1)      5934
cor(Intercept,CommAtt3M2)      5524
cor(CommAtt2M1,CommAtt3M2)     6511

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.01 1.00     4362     4575

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.23      0.01     1.22     1.24 1.00     5205     5979
CommAtt2M1           0.62      0.01     0.61     0.63 1.00    14611     6124
CommAtt3M2          -1.10      0.01    -1.11    -1.08 1.00    12219     6336
Modality1           -0.32      0.01    -0.33    -0.30 1.00    14134     6778
Modality2            0.16      0.01     0.15     0.18 1.00    15159     6553
Big5                 0.32      0.01     0.31     0.34 1.00     4826     6410
Familiarity          0.32      0.01     0.30     0.34 1.00     4174     5246
Expressibility_z     0.12      0.00     0.12     0.13 1.00    13884     6876

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.17      0.00     0.17     0.18 1.00    17858     5344

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m6c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now correlation does not seem to generate problems</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m6c), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m6c, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ppcheck good</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m6c, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m6c check-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nice blob</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>h1.m6c_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5     Q97.5
R2 0.8890392 0.001393478 0.8861745 0.8916361</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 88%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnostics-i" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics-i">Diagnostics I</h2>
<p>We now have several models that we can test for predictive performance.</p>
<section id="rhat" class="level3">
<h3 class="anchored" data-anchor-id="rhat">Rhat</h3>
<p>Rhat tells us whether the model’s Markov chains have converged—values close to 1 mean the model has likely converged well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R-hat values for each model</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>rhat_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_list, <span class="cf">function</span>(model) {</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  rhat_values <span class="ot">&lt;-</span> <span class="fu">rhat</span>(model)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(model)), </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">max_rhat =</span> <span class="fu">max</span>(rhat_values), </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_rhat =</span> <span class="fu">min</span>(rhat_values))</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and inspect</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind, rhat_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   model max_rhat  min_rhat
1 X[[i]] 1.002349 0.9996758
2 X[[i]] 1.011516 0.9997215
3 X[[i]] 1.005103 0.9997167
4 X[[i]] 1.003503 0.9996573
5 X[[i]] 1.004119 0.9996640
6 X[[i]] 1.003712 0.9996386
7 X[[i]] 1.002459 0.9995773
8 X[[i]] 1.002605 0.9996426</code></pre>
</div>
</div>
<p>All models seems actually ok in terms of Rhat values except model 2 (h1.m2)</p>
</section>
<section id="ess" class="level3">
<h3 class="anchored" data-anchor-id="ess">ESS</h3>
<p>Effective sample size tells how many independent samples the model has effectively drawn from the PD. Low ESS suggests autocorrelation (i.e., sample explores one part of posterior), while high ESS means good mix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract n_eff values for each model</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>neff_ratio_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_list, <span class="cf">function</span>(model) {</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  neff_values <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(model)              <span class="co"># Here we calculate ratio (not the raw number of effective samples)</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(model)), </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_neff =</span> <span class="fu">min</span>(neff_values), </span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">max_neff =</span> <span class="fu">max</span>(neff_values),</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">mean_neff =</span> <span class="fu">mean</span>(neff_values))</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and inspect</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind, neff_ratio_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   model   min_neff  max_neff mean_neff
1 X[[i]] 0.23283181 0.8832823 0.6862927
2 X[[i]] 0.04396011 0.9020581 0.6204512
3 X[[i]] 0.14481431 0.8834718 0.7504325
4 X[[i]] 0.22967606 0.9020381 0.7709286
5 X[[i]] 0.11769241 0.9065446 0.7505601
6 X[[i]] 0.20616401 0.9322803 0.7457049
7 X[[i]] 0.28072060 0.8984722 0.7626900
8 X[[i]] 0.18101711 0.9370772 0.7924409</code></pre>
</div>
</div>
<p>So the highest ratio have model h1.m6c (lognormal with correlation) but in fact they are all quite comparable. Let’s loot at 3 highest</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m6c) <span class="co"># this one indeed seems the best as it has all ESS around 10k</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  5193
2       b_CommAtt2M1 14438
3       b_CommAtt3M2 12340
4        b_Modality1 14518
5        b_Modality2 14927
6             b_Big5  4824
7      b_Familiarity  4162
8 b_Expressibility_z 14233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  3104
2       b_CommAtt2M1  9618
3       b_CommAtt3M2  9509
4        b_Modality1  9057
5        b_Modality2  9192
6             b_Big5  2906
7      b_Familiarity  2280
8 b_Expressibility_z 10811</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m3p) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  8533
2       b_CommAtt2M1  2795
3       b_CommAtt3M2  2385
4        b_Modality1 13744
5        b_Modality2 13144
6             b_Big5 12483
7      b_Familiarity 13139
8 b_Expressibility_z 15614</code></pre>
</div>
</div>
<p>So there are some considerable differences for different coefficients</p>
</section>
<section id="loo-waic" class="level3">
<h3 class="anchored" data-anchor-id="loo-waic">LOO &amp; WAIC</h3>
<p>Leave-One-Out (LOO) validation is a technique where, for each iteration, one data point is left out as the test set, and the model is trained on the remaining data points; this process is repeated for each data point, and the model’s overall performance is averaged over all iterations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h1.m1, h1.m2, h1.m3, h1.m3p, h1.m4, h1.m5, h1.m6, h1.m6c, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic
h1.m6c     0.0       0.0 -5070.5     69.3       126.5     3.5  10141.0   138.5 
h1.m6     -0.2       1.5 -5070.7     69.2       120.4     3.3  10141.4   138.5 
h1.m5   -904.2      59.2 -5974.6     74.1       418.5     5.3  11949.3   148.1 
h1.m2  -1143.5      67.5 -6214.0     78.4       285.6    10.7  12428.0   156.8 
h1.m3  -1221.1      66.5 -6291.6     75.5       261.3     7.7  12583.2   150.9 
h1.m3p -1222.5      66.9 -6293.0     76.3       281.6     8.3  12586.0   152.5 
h1.m4  -1224.7      67.4 -6295.2     77.0       281.3     8.4  12590.3   154.0 
h1.m1  -1681.0      72.2 -6751.5     74.9        25.3     0.8  13503.0   149.9 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>elpd_loo: This is the expected log pointwise predictive density for LOO. Higher values indicate a better fit to the data.</p>
<p>se_elpd_loo: The standard error of the elpd_loo, representing uncertainty in the model’s predictive fit according to LOO.</p>
<p>looic: The LOO Information Criterion, which is similar to waic but based on leave-one-out cross-validation. Lower values are better.</p>
<p>p_loo: The effective number of parameters according to LOO, indicating the model’s complexity.</p>
<p>se_p_loo: The standard error of p_loo, representing uncertainty around the effective number of parameters.</p>
</div>
</div>
<p>Model with lognormal distribution seems the best as assessed by LOO.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h1.m1, h1.m2, h1.m3, h1.m3p, h1.m4, h1.m5, h1.m6, h1.m6c, <span class="at">criterion =</span> <span class="st">"waic"</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(w, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic   
h1.m6c     0.0       0.0 -5070.3      69.3        126.3     3.5   10140.5
h1.m6     -0.3       1.5 -5070.5      69.2        120.2     3.3   10141.0
h1.m5   -903.7      59.2 -5974.0      74.1        417.8     5.3   11948.0
h1.m2  -1142.2      67.5 -6212.5      78.3        284.1    10.6   12424.9
h1.m3  -1220.4      66.5 -6290.7      75.4        260.3     7.6   12581.3
h1.m3p -1221.6      66.9 -6291.8      76.2        280.4     8.2   12583.7
h1.m4  -1223.8      67.3 -6294.1      77.0        280.3     8.4   12588.2
h1.m1  -1681.2      72.2 -6751.5      74.9         25.3     0.8   13502.9
       se_waic
h1.m6c   138.5
h1.m6    138.5
h1.m5    148.1
h1.m2    156.6
h1.m3    150.9
h1.m3p   152.5
h1.m4    153.9
h1.m1    149.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see Solomon Kurz</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">waic_diff =</span> w[,<span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> w[,<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          waic_diff         se
h1.m6c    0.0000000   0.000000
h1.m6     0.5289111   2.917133
h1.m5  1807.4580148 118.471557
h1.m2  2284.3843630 134.987550
h1.m3  2440.8062251 132.903242
h1.m3p 2443.1522534 133.864984
h1.m4  2447.6767321 134.678147
h1.m1  3362.3866702 144.475730</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>elpd_waic (expected log pointwise predictive density for WAIC): This represents the model’s predictive fit to the data. Higher values indicate a better fit.</p>
<p>se_elpd_waic (standard error of elpd_waic): Measures uncertainty around the elpd_waic estimate.</p>
<p>waic: The Widely Applicable Information Criterion, a measure of model fit where lower values indicate a better fit.</p>
<p>se_waic (standard error of WAIC): Uncertainty around the WAIC estimate.</p>
<p>elpd_diff: The difference in the elpd_waic between the model in question and the baseline model (fit_eff_2, which has elpd_diff of 0). A negative value indicates that the model fits worse than fit_eff_2.</p>
<p>se_diff: The standard error of the elpd_diff, indicating how much uncertainty there is in the difference in predictive performance.</p>
<p>p_waic: The number of effective parameters in the model (related to model complexity). Lower values indicate simpler models, and higher values suggest more complexity.</p>
</div>
</div>
<p>Plot the comparison</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1 waic plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(h1.m1, h1.m2, h1.m3, h1.m3p, h1.m4, h1.m5, h1.m6, h1.m6c, <span class="at">weights =</span> <span class="st">"waic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> h1.m1  h1.m2  h1.m3 h1.m3p  h1.m4  h1.m5  h1.m6 h1.m6c 
  0.00   0.00   0.00   0.00   0.00   0.00   0.43   0.57 </code></pre>
</div>
</div>
<p>So as ppcheck already suggested, lognormal model indeed seem to have the most predictive power. For this particular (synthetic) data, we will now proceed with model h1.m6c</p>
<p>We will first add some mildly informative priors, and then we also try to add some interaction terms and do a comparison once again.</p>
</section>
</section>
<section id="model-7---lognormal-with-priors" class="level2">
<h2 class="anchored" data-anchor-id="model-7---lognormal-with-priors">Model 7 - lognormal with priors</h2>
<p>Let’s first check what priors have been selected as default for h1.m6c</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print priors</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(h1.m6c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class             coef         group resp dpar
                 (flat)         b                                         
                 (flat)         b             Big5                        
                 (flat)         b       CommAtt2M1                        
                 (flat)         b       CommAtt3M2                        
                 (flat)         b Expressibility_z                        
                 (flat)         b      Familiarity                        
                 (flat)         b        Modality1                        
                 (flat)         b        Modality2                        
 student_t(3, 1.3, 2.5) Intercept                                         
   lkj_corr_cholesky(1)         L                                         
   lkj_corr_cholesky(1)         L                        Concept          
   lkj_corr_cholesky(1)         L                    Participant          
   student_t(3, 0, 2.5)        sd                                         
   student_t(3, 0, 2.5)        sd                        Concept          
   student_t(3, 0, 2.5)        sd       CommAtt2M1       Concept          
   student_t(3, 0, 2.5)        sd       CommAtt3M2       Concept          
   student_t(3, 0, 2.5)        sd        Intercept       Concept          
   student_t(3, 0, 2.5)        sd                    Participant          
   student_t(3, 0, 2.5)        sd       CommAtt2M1   Participant          
   student_t(3, 0, 2.5)        sd       CommAtt3M2   Participant          
   student_t(3, 0, 2.5)        sd        Intercept   Participant          
   student_t(3, 0, 2.5)        sd                  TrialNumber_c          
   student_t(3, 0, 2.5)        sd        Intercept TrialNumber_c          
   student_t(3, 0, 2.5)     sigma                                         
 nlpar lb ub       source
                  default
             (vectorized)
             (vectorized)
             (vectorized)
             (vectorized)
             (vectorized)
             (vectorized)
             (vectorized)
                  default
                  default
             (vectorized)
             (vectorized)
        0         default
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0    (vectorized)
        0         default</code></pre>
</div>
</div>
<p>Wee can keep all defaulted ones, but we do not need to leave flat priors for the beta coefficients as we do have some assumptions/expectations</p>
<p>Let’s reuse priors we have already used for h1.m3p</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>priors_h1m7 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(2.5, 0.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>, <span class="at">lb=</span><span class="dv">0</span>),</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt2M1"</span>),</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt3M2"</span>),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality1"</span>),</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality2"</span>),</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Big5"</span>),</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Familiarity"</span>),</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Expressibility_z"</span>)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The rest we will leave default (and check afterwards)</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>h1.m7 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> TrialNumber_c), </span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior =</span> priors_h1m7,</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>h1.m7 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m7, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>h1.m7_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m7)</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m7, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m7.rds"</span>))</span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m7_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m7_R2.rds"</span>))</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>h1.m7 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m7.rds"</span>))</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>h1.m7_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m7_R2.rds"</span>))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 + CommAtt | Participant) + (1 + CommAtt | Concept) + (1 | TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.01      0.00     0.00     0.02 1.00     2406
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5336
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     3663
cor(Intercept,CommAtt2M1)      0.27      0.49    -0.79     0.95 1.00     9049
cor(Intercept,CommAtt3M2)      0.34      0.47    -0.74     0.95 1.00     7153
cor(CommAtt2M1,CommAtt3M2)    -0.05      0.50    -0.89     0.88 1.00     8030
                           Tail_ESS
sd(Intercept)                  2582
sd(CommAtt2M1)                 4860
sd(CommAtt3M2)                 4212
cor(Intercept,CommAtt2M1)      5794
cor(Intercept,CommAtt3M2)      6108
cor(CommAtt2M1,CommAtt3M2)     5937

~Participant (Number of levels: 120) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.05      0.00     0.04     0.06 1.00     3562
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5277
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     3118
cor(Intercept,CommAtt2M1)      0.34      0.46    -0.72     0.95 1.00    11493
cor(Intercept,CommAtt3M2)     -0.40      0.40    -0.94     0.57 1.00     7854
cor(CommAtt2M1,CommAtt3M2)    -0.26      0.48    -0.94     0.77 1.00     5771
                           Tail_ESS
sd(Intercept)                  5189
sd(CommAtt2M1)                 4743
sd(CommAtt3M2)                 3237
cor(Intercept,CommAtt2M1)      6204
cor(Intercept,CommAtt3M2)      5447
cor(CommAtt2M1,CommAtt3M2)     6837

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.01 1.00     4640     4109

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            1.23      0.01     1.22     1.24 1.00     5166     5351
CommAtt2M1           0.62      0.01     0.61     0.63 1.00    12440     6165
CommAtt3M2          -1.10      0.01    -1.11    -1.08 1.00    10543     6212
Modality1           -0.31      0.01    -0.33    -0.30 1.00    13106     5622
Modality2            0.16      0.01     0.15     0.17 1.00    13551     6493
Big5                 0.32      0.01     0.31     0.34 1.00     4012     4552
Familiarity          0.32      0.01     0.30     0.34 1.00     4337     5552
Expressibility_z     0.12      0.00     0.12     0.13 1.00    11948     6505

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.17      0.00     0.17     0.18 1.00    15087     5361

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m7), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m7, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nice</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m7, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 check-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>h1.m7_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5     Q97.5
R2 0.8889672 0.001399296 0.8861732 0.8916425</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 88%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s now also check whether the priors make sense</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 ppd check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 ppd check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m7 ppd check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-8---adding-interactions" class="level2">
<h2 class="anchored" data-anchor-id="model-8---adding-interactions">Model 8 - adding interactions</h2>
<p>Possible interactions include:</p>
<ul>
<li><p>CommAtt x Modality - Effort could increase differently across modalities, depending on whether concept is guessed on the first, second or third attempt. E.g., gesture might require more effort on initial attempt, but vocal require more effort in repeated attempt. This is interesting question and it would help disentangle the benfit of multimodality over unimodality (i.e., multimodal trials might be more effortful, but overal have less attempts). However, we already model effect of modality on effort, so maybe this is not top priority.</p></li>
<li><p>CommAtt x Expressibility - Higher expressibility should moderate the effect of repeated attempts, such that the increase in effort with each additional attempt is smaller (or bigger?) for more expressible concepts.This is not a priority for our analysis.</p></li>
<li><p>Modality × Expressibility_z - The influence of expressibility on effort could be modality-specific — perhaps effort increases less with expressibility in the combined modality. For our analysis, this is also not a priority (especially since expressibiliy has already modality encoded)</p></li>
<li><p>Familiarity x CommAtt - More familiar partners may guess faster (fewer attempts) and require less effort, but this effect could diminish over multiple attempts. For our analysis, this is not a priority,</p></li>
<li><p>Big5 × Modality or Big5 × CommAtt - More open/extraverted participants might maintain higher effort over attempts, or adjust more dynamically depending on the communicative channel. While not priority, it is an interesting question if we want to tap more into the inter-individual variability.</p></li>
</ul>
<p>Let’s try CommAtt x Modality and Big5 x CommAtt</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>h1.m8 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Eff <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">*</span> Modality <span class="sc">+</span> Big5 <span class="sc">*</span> CommAtt <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> CommAtt <span class="sc">|</span> Concept) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> TrialNumber_c), </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> final_data,</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior =</span> priors_h1m7, <span class="co"># we keep the priors from previous model</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>h1.m8 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h1.m8, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>h1.m8_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h1.m8)</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m8, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m8.rds"</span>))</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h1.m8_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m8_R2.rds"</span>))</span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>h1.m8 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m8.rds"</span>))</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>h1.m8_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h1.m8_R2.rds"</span>))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h1.m8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: Eff ~ 1 + CommAtt * Modality + Big5 * CommAtt + Familiarity + Expressibility_z + (1 + CommAtt | Participant) + (1 + CommAtt | Concept) + (1 | TrialNumber_c) 
   Data: final_data (Number of observations: 5076) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.01      0.00     0.00     0.02 1.00     2549
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5836
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     4322
cor(Intercept,CommAtt2M1)      0.29      0.48    -0.76     0.94 1.00    10754
cor(Intercept,CommAtt3M2)      0.36      0.46    -0.70     0.95 1.00     8535
cor(CommAtt2M1,CommAtt3M2)    -0.04      0.50    -0.89     0.86 1.00     7971
                           Tail_ESS
sd(Intercept)                  2905
sd(CommAtt2M1)                 4937
sd(CommAtt3M2)                 4495
cor(Intercept,CommAtt2M1)      5912
cor(Intercept,CommAtt3M2)      6615
cor(CommAtt2M1,CommAtt3M2)     6944

~Participant (Number of levels: 120) 
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                  0.05      0.00     0.04     0.06 1.00     3682
sd(CommAtt2M1)                 0.01      0.00     0.00     0.02 1.00     5068
sd(CommAtt3M2)                 0.01      0.01     0.00     0.03 1.00     3392
cor(Intercept,CommAtt2M1)      0.34      0.45    -0.71     0.94 1.00    12364
cor(Intercept,CommAtt3M2)     -0.41      0.39    -0.94     0.57 1.00     9996
cor(CommAtt2M1,CommAtt3M2)    -0.26      0.49    -0.95     0.78 1.00     5862
                           Tail_ESS
sd(Intercept)                  5433
sd(CommAtt2M1)                 5479
sd(CommAtt3M2)                 3982
cor(Intercept,CommAtt2M1)      5945
cor(Intercept,CommAtt3M2)      6038
cor(CommAtt2M1,CommAtt3M2)     6673

~TrialNumber_c (Number of levels: 50) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.01 1.00     4900     4106

Regression Coefficients:
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                1.23      0.01     1.22     1.24 1.00     5217
CommAtt2M1               0.62      0.01     0.61     0.63 1.00    14494
CommAtt3M2              -1.10      0.01    -1.11    -1.08 1.00    13959
Modality1               -0.31      0.01    -0.33    -0.30 1.00    12978
Modality2                0.16      0.01     0.15     0.18 1.00    13925
Big5                     0.32      0.01     0.30     0.34 1.00     4506
Familiarity              0.32      0.01     0.30     0.34 1.00     3885
Expressibility_z         0.12      0.00     0.12     0.13 1.00    12340
CommAtt2M1:Modality1     0.01      0.02    -0.02     0.04 1.00    13065
CommAtt3M2:Modality1     0.01      0.02    -0.03     0.05 1.00    12851
CommAtt2M1:Modality2    -0.01      0.02    -0.04     0.02 1.00    13667
CommAtt3M2:Modality2     0.02      0.02    -0.02     0.06 1.00    12109
CommAtt2M1:Big5         -0.00      0.01    -0.02     0.02 1.00    14725
CommAtt3M2:Big5         -0.01      0.01    -0.04     0.01 1.00    14109
                     Tail_ESS
Intercept                6099
CommAtt2M1               7032
CommAtt3M2               6248
Modality1                6662
Modality2                6627
Big5                     5386
Familiarity              5579
Expressibility_z         6403
CommAtt2M1:Modality1     6974
CommAtt3M2:Modality1     6884
CommAtt2M1:Modality2     6960
CommAtt3M2:Modality2     6404
CommAtt2M1:Big5          6229
CommAtt3M2:Big5          6504

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.17      0.00     0.17     0.18 1.00    17574     5831

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients remain mostly unchanged </span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we did not really focused on the interactions during the simulation, we also don't have strong expectations here. But for the real data, there is a good reason to expect some meaningful values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.m8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h1.m8), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the effects all go in good direction</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we can see here that combined modality remains moderated across all commatts</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and also big5 seems to matter the most in the second attempt</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m8, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the problem with predicting negative values remains</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h1.m8, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h1.m8 check-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unchanged</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>h1.m8_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5     Q97.5
R2 0.8889759 0.001459646 0.8859485 0.8916926</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance remains around 87%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnostics-ii" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics-ii">Diagnostics II</h2>
<section id="ess-1" class="level3">
<h3 class="anchored" data-anchor-id="ess-1">ESS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m6) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  3104
2       b_CommAtt2M1  9618
3       b_CommAtt3M2  9509
4        b_Modality1  9057
5        b_Modality2  9192
6             b_Big5  2906
7      b_Familiarity  2280
8 b_Expressibility_z 10811</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m6c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  5193
2       b_CommAtt2M1 14438
3       b_CommAtt3M2 12340
4        b_Modality1 14518
5        b_Modality2 14927
6             b_Big5  4824
7      b_Familiarity  4162
8 b_Expressibility_z 14233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m7) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept  5149
2       b_CommAtt2M1 12363
3       b_CommAtt3M2 10483
4        b_Modality1 13095
5        b_Modality2 13808
6             b_Big5  3976
7      b_Familiarity  4298
8 b_Expressibility_z 11917</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h1.m8) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Parameter   ESS
1             b_Intercept  5221
2            b_CommAtt2M1 14165
3            b_CommAtt3M2 13961
4             b_Modality1 12872
5             b_Modality2 13799
6                  b_Big5  4484
7           b_Familiarity  3878
8      b_Expressibility_z 12296
9  b_CommAtt2M1:Modality1 13103
10 b_CommAtt3M2:Modality1 12880
11 b_CommAtt2M1:Modality2 13651
12 b_CommAtt3M2:Modality2 12303
13      b_CommAtt2M1:Big5 15040
14      b_CommAtt3M2:Big5 13963</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now h1m6 looks as the weakest, while h1m8 looks much better - but ESS for Intercept is for some reason still quite low</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loo-waic-1" class="level3">
<h3 class="anchored" data-anchor-id="loo-waic-1">LOO &amp; WAIC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h1.m6, h1.m6c, h1.m7, h1.m8, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic
h1.m6c     0.0       0.0 -5070.5     69.3       126.5     3.5  10141.0   138.5 
h1.m6     -0.2       1.5 -5070.7     69.2       120.4     3.3  10141.4   138.5 
h1.m7     -0.3       0.2 -5070.8     69.3       126.8     3.5  10141.5   138.6 
h1.m8     -4.4       1.9 -5074.8     69.2       132.9     3.7  10149.7   138.5 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h1.m6, h1.m6c, h1.m7, h1.m8, <span class="at">criterion =</span> <span class="st">"waic"</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(w, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic   
h1.m6c     0.0       0.0 -5070.3      69.3        126.3     3.5   10140.5
h1.m6     -0.3       1.5 -5070.5      69.2        120.2     3.3   10141.0
h1.m7     -0.3       0.2 -5070.5      69.3        126.5     3.5   10141.1
h1.m8     -4.4       1.9 -5074.6      69.2        132.7     3.7   10149.2
       se_waic
h1.m6c   138.5
h1.m6    138.5
h1.m7    138.6
h1.m8    138.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see Solomon Kurz</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">waic_diff =</span> w[,<span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> w[,<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       waic_diff        se
h1.m6c 0.0000000 0.0000000
h1.m6  0.5289111 2.9171328
h1.m7  0.5582963 0.3803033
h1.m8  8.7265395 3.7869214</code></pre>
</div>
</div>
<p>So in terms of WAIC &amp; LOO, interactions do not really add predictive power. This might be specific for the synthetic data, as we did not explicitly focused on the interaction coefficients there. At the same time, the difference of h1.m8 from h1.m6c is not so significant. For now, we stop here. With the full data, we will proceed with the same evaluation.</p>
</section>
</section>
</section>
<section id="h2-modelling" class="level1">
<h1>H2: Modelling</h1>
<p>Now we can need to account also for our second hypothesis, namely</p>
<p><em>H2: A higher degree of misunderstanding will require a performer to engage in more effortful correction.</em></p>
<p>We operationalize degree of misunderstanding as a cosine similarity of performer’s target and guesser’s answer (PrevAn). The difficulty with our data structure is that PrevAn is a variable that has values only for second and third correction (i.e., there is no previous answer for the first performance). If we left it unchange, the model will eventually get rid of all NA values, which means we will loose the relationship between effort in second and first communicative attempt. To avoid this, we will create a new variable which we call <em>Effort Change</em>. We will simply calculate the change from effort in communicative attempt x to communicative attempt x+1. We will still loose communicative attempt 1, but the change that will be associated with CommAtt==2 already encapsulates the relationship towards this attempt.</p>
<section id="data-wrangling-i" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-i">Data wrangling I</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Effort Change (Difference)</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>final_data_2 <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Participant, Concept) <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_1 =</span> Eff[CommAtt <span class="sc">==</span> <span class="dv">1</span>][<span class="dv">1</span>],  <span class="co"># Effort for attempt 1</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_2 =</span> Eff[CommAtt <span class="sc">==</span> <span class="dv">2</span>][<span class="dv">1</span>],  <span class="co"># Effort for attempt 2</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_3 =</span> Eff[CommAtt <span class="sc">==</span> <span class="dv">3</span>][<span class="dv">1</span>],  <span class="co"># Effort for attempt 3</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_Change_1_to_2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>      CommAtt <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Effort_1) <span class="sc">~</span> Eff <span class="sc">-</span> Effort_1,  <span class="co"># Change from 1st to 2nd attempt</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_Change_2_to_3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>      CommAtt <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Effort_2) <span class="sc">~</span> Eff <span class="sc">-</span> Effort_2,  <span class="co"># Change from 2nd to 3rd attempt</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Collide changes into a single column</span></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>final_data_2 <span class="ot">&lt;-</span> final_data_2 <span class="sc">%&gt;%</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Effort_Change =</span> <span class="fu">coalesce</span>(Effort_Change_1_to_2, Effort_Change_2_to_3)</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary columns</span></span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>final_data_2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(final_data_2, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Effort_1, Effort_2, Effort_3, Effort_Change_1_to_2, Effort_Change_2_to_3)) </span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a><span class="co"># View the result</span></span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_data_2, <span class="at">n=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 11
   Participant Concept Modality  Big5 Familiarity Expressibility CommAtt   Eff
         &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1           1       1 combined  1.92        1.84        0.576         1  4.34
 2           1       1 combined  1.92        1.84        0.576         2  6.57
 3           1       1 combined  1.92        1.84        0.576         3  2.37
 4           1       2 gesture   1.92        1.84        0.349         1  5.50
 5           1       2 gesture   1.92        1.84        0.349         2 10.4 
 6           1       2 gesture   1.92        1.84        0.349         3  4.00
 7           1       3 vocal     1.92        1.84        0.340         1  6.15
 8           1       3 vocal     1.92        1.84        0.340         2 12.9 
 9           1       3 vocal     1.92        1.84        0.340         3  3.59
10           1       4 combined  1.92        1.84        0.719         1  4.09
11           1       4 combined  1.92        1.84        0.719         2  6.41
12           1       5 gesture   1.92        1.84        0.0781        1  5.28
13           1       6 gesture   1.92        1.84        0.00419       1  5.61
14           1       6 gesture   1.92        1.84        0.00419       2 12.0 
15           1       6 gesture   1.92        1.84        0.00419       3  3.44
# ℹ 3 more variables: TrialNumber &lt;dbl&gt;, PrevAn &lt;dbl&gt;, Effort_Change &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="exploring-structure" class="level2">
<h2 class="anchored" data-anchor-id="exploring-structure">Exploring structure</h2>
<p>This is the relationship between effort and answer similarity (H2) as seen in the raw (synthetic) data</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 plot 2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is how effort change is distributed</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So we will have to work with bimodal distribution, as we either have a decrease in effort or increase</p>
</section>
</section>
<section id="h2-stating-causal-model" class="level1">
<h1>H2: Stating causal model</h1>
<p>We now also need a new DAG. Essentially, what we said will influence CommAtt in H1, will now also influence PrevAn because they are tightly related. For instance, more extroverted people can be expected to be better guessers, therefore the similarity of the previous answer will be higher.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/dag h2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>dagitty<span class="sc">::</span><span class="fu">adjustmentSets</span>(daggy_h2, <span class="at">exposure =</span> <span class="st">"PrevAn"</span>, <span class="at">outcome =</span> <span class="st">"EffChange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{ Big5, Conc, Expr, Fam, Mod, Pcn, TrNum }</code></pre>
</div>
</div>
<p>The adjustment set is identical to the one of H1. Note that we are here omitting arrows going from all these variables to ComAtt. Since PrevAn affects CommAtt, and not the other way, we do not need to block this path to avoid confounds. However, if we want to asses direct effect of PrevAn on EffChange, we have to add CommAtt to the model as well.</p>
</section>
<section id="h2-modelling-1" class="level1">
<h1>H2: Modelling</h1>
<p>Converting columns to factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(filtered_data<span class="sc">$</span>CommAtt)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(filtered_data<span class="sc">$</span>CommAtt) <span class="co"># commatt1 still remains as a level</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(filtered_data<span class="sc">$</span>CommAtt) <span class="co"># redo again</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>Modality <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(filtered_data<span class="sc">$</span>Modality)</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>Participant <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(filtered_data<span class="sc">$</span>Participant)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>Concept <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(filtered_data<span class="sc">$</span>Concept)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>TrialNumber <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(filtered_data<span class="sc">$</span>TrialNumber)  <span class="co"># Ensure TrialNumber is numeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrast-coding for categorical predictors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(filtered_data<span class="sc">$</span>CommAtt) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">1</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(filtered_data<span class="sc">$</span>Modality) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Centering continuous predictors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>TrialNumber_c <span class="ot">&lt;-</span> filtered_data<span class="sc">$</span>TrialNumber <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(filtered_data<span class="sc">$</span>TrialNumber))</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>Familiarity <span class="ot">&lt;-</span> filtered_data<span class="sc">$</span>Familiarity <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(filtered_data<span class="sc">$</span>Familiarity))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>Big5 <span class="ot">&lt;-</span> filtered_data<span class="sc">$</span>Big5 <span class="sc">-</span> <span class="fu">median</span>(<span class="fu">range</span>(filtered_data<span class="sc">$</span>Big5))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Z-scoring expressibility and similarity (PrevAn)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="sc">|&gt;</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Modality) <span class="sc">|&gt;</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expressibility_z =</span> (Expressibility <span class="sc">-</span> <span class="fu">mean</span>(Expressibility))<span class="sc">/</span> <span class="fu">sd</span>(filtered_data<span class="sc">$</span>Expressibility, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="sc">|&gt;</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PrevAn_z =</span> (PrevAn <span class="sc">-</span> <span class="fu">mean</span>(PrevAn))<span class="sc">/</span> <span class="fu">sd</span>(filtered_data<span class="sc">$</span>PrevAn, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- z-scoring -->
<p>Note: maybe we should center where we z-score to get better sense of the predictors (right now, for me it’s still a bit uninterpretable)</p>
<!-- z-scoring -->
<section id="model-1---dag" class="level2">
<h2 class="anchored" data-anchor-id="model-1---dag">Model 1 - DAG</h2>
<p>Similarly to H1, we will start with reproducing the DAG for H2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>h2.m1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(Effort_Change <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> PrevAn_z <span class="sc">+</span> CommAtt <span class="sc">+</span> Familiarity <span class="sc">+</span> Big5 <span class="sc">+</span> Expressibility_z <span class="sc">+</span> TrialNumber_c <span class="sc">+</span> Modality <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Concept),</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> filtered_data,</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>h2.m1 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h2.m1, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>h2.m1_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h2.m1)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.m1, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.m1.rds"</span>))</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.m1_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.m1_R2.rds"</span>))</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>h2.m1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.m1.rds"</span>))</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>h2.m1_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.m1_R2.rds"</span>))</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h2.m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Effort_Change ~ 1 + PrevAn_z + CommAtt + Familiarity + Big5 + Expressibility_z + TrialNumber_c + Modality + (1 | Participant) + (1 | Concept) 
   Data: filtered_data (Number of observations: 2556) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.03      0.02     0.00     0.09 1.00     5564     4490

~Participant (Number of levels: 120) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.02      0.02     0.00     0.07 1.00     6328     4353

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -0.66      0.03    -0.71    -0.60 1.00    13909     5911
PrevAn_z            -0.62      0.02    -0.66    -0.57 1.00    17850     5508
CommAtt1             3.73      0.03     3.68     3.79 1.00    19981     5855
Familiarity          0.15      0.05     0.06     0.24 1.00    16619     5695
Big5                 0.14      0.04     0.06     0.23 1.00    16358     5795
Expressibility_z     0.08      0.03     0.02     0.13 1.00    17823     5427
TrialNumber_c        0.00      0.00    -0.00     0.01 1.00    11346     5008
Modality1           -0.14      0.07    -0.28     0.00 1.00    13812     6660
Modality2            0.01      0.07    -0.12     0.15 1.00    11997     6265

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.25      0.02     1.21     1.29 1.00    19597     4922

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients seem quite conservative, even for PrevAn (but remember, it's z-scored)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2.m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all looks ok</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h2.m1), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the main effect seems ok, the rest of the predictors does not show nothing (maybe because of the transformation we lost the relations between them and the effort)</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.m1, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this looks quite okay-ish</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.m1, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.m1 check-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># so there seems to be quite high residual error</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>h2.m1_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error      Q2.5     Q97.5
R2 0.8921087 0.001381664 0.8892535 0.8946349</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance around 89%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We see two modes in the distribution of the predictor. While Gaussian family seems to deal with it well, we could also consider model with mixture of two Gaussian distributions. This will allow each mode to have their own mean and variance. With effort change being distributed over positive as well as negative values, lognormal distribution is not applicable.</p>
<p>Importantly, there are some diagnostics we should be cautious about - the relationship between predicted values and residual error is quite correlated.</p>
<p>Also notice the high explained variance indicated by R^2. In real case, this would be almost pointing to over-fitting issues. However, we created synthetic data that does not contain as much noise as we can expect from the real data, so it is quite likely that if we simply used all predictors we know to cause a variance here, we might be explaining most of the variation. It is quite likely this will not be the case for real data.</p>
</section>
<section id="splines-1---fitting-b-splines" class="level2">
<h2 class="anchored" data-anchor-id="splines-1---fitting-b-splines">Splines 1 - fitting b-splines</h2>
<p>In the previous model for H1, we were able to spot possible non-linear trends by contrast coding of the communicative attempts whereby each level was defined relative to the two remaining. Now, we are dealing with situation where both outcome variable and the main predictor are continuous variable. Also here we might expect nonlinear patterns in their relationship. For instance, it might be the case that for answers that are completely off, people do not feel motivated to put in more effort, and some kind of sensible ‘threshold’ needs to be reached for the effort to increase to resolve misunderstanding, and then again decrease when the answer is very similar.</p>
<p>We will use a combination of B-splines and Bayesian GAMs to prepare some models and try them fit to the synthetic data. However, note that we currently do not expect any non-linearity as we have not coded any within the simulation, as seen in the following plot fitted with loess method.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 plot nonlinear-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>B-splines allow to build up wiggly functions from more simple components which are called ‘basis functions’ (B). They divide a full range of predictor into parts and assign a parameter to each part. The parameters are gradually turned on and off in a way that makes their sum into a curve. Unlike polynomial regression, b-splines do not transform predictor, but they invent a series of new synthetic predictor variables. Each of them then exists only to gradually turn a specific parameter on and off within a specific range of the real predictor variable. Each of these synthetic variables is called a basis function B. See more in Richard McElreath’s Statistical Rethinking (<span class="citation" data-cites="mcelreath18">McElreath (<a href="#ref-mcelreath18" role="doc-biblioref">2018</a>)</span>).</p>
<p>We are using the <a href="https://bookdown.org/content/4857/geocentric-models.html">code</a> from Solomon Kurz’s adaptation of this book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of NAs in the predictor</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  final_data_2 <span class="sc">%&gt;%</span> </span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(PrevAn)</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co"># And convert all that is necessary to factor/numerical</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>CommAtt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>CommAtt)</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Modality <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>Modality)</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Participant <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>Participant)</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Concept <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(d<span class="sc">$</span>Concept)</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>TrialNumber <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(d<span class="sc">$</span>TrialNumber) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we can see summary of each predictor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span>  <span class="co"># Select only numeric columns</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"key"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll   =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.055</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ul   =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.945</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.double), round, <span class="at">digits =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  key             mean    sd    ll    ul
  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Big5            0.98  0.57  0.09  1.93
2 Eff             5.1   2.79  1.43  9.79
3 Effort_Change   0.54  3.8  -5.92  4.99
4 Expressibility  0.47  0.38  0.07  1.32
5 Familiarity     1.13  0.55  0.15  1.9 
6 PrevAn          0.5   0.29  0.05  0.94
7 TrialNumber    22.6  12.4   3    42   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 11
   Participant Concept Modality  Big5 Familiarity Expressibility CommAtt   Eff
   &lt;fct&gt;       &lt;fct&gt;   &lt;fct&gt;    &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;
 1 1           1       combined  1.92        1.84        0.576   2        6.57
 2 1           1       combined  1.92        1.84        0.576   3        2.37
 3 1           2       gesture   1.92        1.84        0.349   2       10.4 
 4 1           2       gesture   1.92        1.84        0.349   3        4.00
 5 1           3       vocal     1.92        1.84        0.340   2       12.9 
 6 1           3       vocal     1.92        1.84        0.340   3        3.59
 7 1           4       combined  1.92        1.84        0.719   2        6.41
 8 1           6       gesture   1.92        1.84        0.00419 2       12.0 
 9 1           6       gesture   1.92        1.84        0.00419 3        3.44
10 1           8       vocal     1.92        1.84        0.591   2        9.11
# ℹ 3 more variables: TrialNumber &lt;dbl&gt;, PrevAn &lt;dbl&gt;, Effort_Change &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now we need to specify knots that function as pivots for number of different basis functions. The B variable then tells you which knot you are close to.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>knot_list <span class="ot">&lt;-</span> <span class="fu">quantile</span>(d<span class="sc">$</span>PrevAn, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> num_knots))</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>knot_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          0%    16.66667%    33.33333%          50%    66.66667%    83.33333% 
0.0001020494 0.1540585973 0.3319149296 0.5038721841 0.6719870094 0.8383128390 
        100% 
0.9989464423 </code></pre>
</div>
</div>
<p>Now we can see how we chopped the data by the knots</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 knot plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we need to specify the polynomial degree which determines how parameters interact to produce the spline.</p>
<p>For degree 1, two basis functions combine at each point. For degree 2, three functions combine at each point. For degree 3, four combine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">bs</span>(d<span class="sc">$</span>PrevAn,</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">knots =</span> knot_list[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, num_knots)], </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">degree =</span> <span class="dv">3</span>, <span class="co"># cubic spline</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">intercept =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is how cubic spline with 7 knots look like</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/b-spline plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We will now add this B matrix into the data to be able to further use it in the models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">B =</span> B) </span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at the structure of `d3</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,556
Columns: 12
$ Participant    &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ Concept        &lt;fct&gt; 1, 1, 2, 2, 3, 3, 4, 6, 6, 8, 8, 9, 9, 14, 15, 15, 17, …
$ Modality       &lt;fct&gt; combined, combined, gesture, gesture, vocal, vocal, com…
$ Big5           &lt;dbl&gt; 1.919899, 1.919899, 1.919899, 1.919899, 1.919899, 1.919…
$ Familiarity    &lt;dbl&gt; 1.8439059, 1.8439059, 1.8439059, 1.8439059, 1.8439059, …
$ Expressibility &lt;dbl&gt; 0.576172309, 0.576172309, 0.349378655, 0.349378655, 0.3…
$ CommAtt        &lt;fct&gt; 2, 3, 2, 3, 2, 3, 2, 2, 3, 2, 3, 2, 3, 2, 2, 3, 2, 3, 2…
$ Eff            &lt;dbl&gt; 6.566250, 2.367010, 10.367605, 3.998448, 12.934986, 3.5…
$ TrialNumber    &lt;dbl&gt; 2, 3, 5, 6, 8, 9, 11, 14, 15, 18, 19, 21, 22, 28, 30, 3…
$ PrevAn         &lt;dbl&gt; 0.98450637, 0.82035722, 0.48565959, 0.09090184, 0.19707…
$ Effort_Change  &lt;dbl&gt; 2.222401, -4.199240, 4.869752, -6.369157, 6.781893, -9.…
$ B              &lt;bs[,9]&gt; &lt;bs[26 x 9]&gt;</code></pre>
</div>
</div>
<p>The B matrix is now a matrix column which contains the same number of rows as the others, but has also 9 columns within that columns. Each of them correspond to one synthetic B variable.</p>
<p>We can now use this matrix to fit our model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>h2.s1 <span class="ot">&lt;-</span> </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d2,</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>      Effort_Change <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> B,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">100</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>)</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>h2.s1 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h2.s1, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a>h2.s1_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h2.s1)</span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s1, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s1.rds"</span>))</span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s1_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s1_R2.rds"</span>))</span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>h2.s1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s1.rds"</span>))</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>h2.s1_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s1_R2.rds"</span>))</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(h2.s1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Effort_Change ~ 1 + B 
   Data: d2 (Number of observations: 2556) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.60      3.29    -5.87     6.72 1.00     1022     1772
B1            0.54      3.32    -5.66     7.08 1.00     1043     1951
B2            0.15      3.34    -6.13     6.70 1.00     1044     1856
B3            1.83      3.34    -4.47     8.44 1.00     1057     1901
B4           -0.33      3.32    -6.66     6.19 1.00     1042     1844
B5            0.42      3.31    -5.80     6.88 1.00     1041     1814
B6           -0.81      3.31    -7.00     5.71 1.00     1036     1880
B7           -0.57      3.33    -6.88     5.95 1.00     1049     1780
B8           -0.89      3.34    -7.14     5.67 1.00     1067     2043
B9           -1.21      3.32    -7.50     5.35 1.00     1039     1822

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     3.75      0.05     3.65     3.85 1.00     4696     4264

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>It’s a bit difficult to see what is going on so let’s just plot it</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now with the predictor</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 plot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So as expected, we see quite linear decrease similar to our previous models</p>
<p>Now let’s check some diagnostics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2.s1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks good</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s1, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because we used only main predictor, we can see quite a bad result of the posterior predictive distribution, but we will work on that</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s1, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s1 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># high residual error for both low and high values</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>h2.s1_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Estimate   Est.Error       Q2.5      Q97.5
R2 0.0299754 0.006354033 0.01827862 0.04305631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance 2%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="splines-2---bayesian-gams" class="level2">
<h2 class="anchored" data-anchor-id="splines-2---bayesian-gams">Splines 2 - Bayesian GAMs</h2>
<p>Now we will use a different workflow, using smooth functions with <code>brms</code> package. Brms allow for non-linear models by borrowing functions from <code>mgcv</code> package (<span class="citation" data-cites="wood17">Wood (<a href="#ref-wood17" role="doc-biblioref">2017</a>)</span>)</p>
<p>This is how priors should look like for one of these functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(<span class="at">data =</span> d2,</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> gaussian,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>          Effort_Change <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(PrevAn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b sPrevAn_1                            
 student_t(3, 2.1, 2.7) Intercept                                      
   student_t(3, 0, 2.7)       sds                                  0   
   student_t(3, 0, 2.7)       sds s(PrevAn)                        0   
   student_t(3, 0, 2.7)     sigma                                  0   
       source
      default
 (vectorized)
      default
      default
 (vectorized)
      default</code></pre>
</div>
</div>
<p>At this point, I will just keep priors at default</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>h2.s2 <span class="ot">&lt;-</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d2,</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>      Effort_Change <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">s</span>(PrevAn, <span class="at">bs =</span> <span class="st">"bs"</span>, <span class="at">k =</span> <span class="dv">19</span>),</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, </span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">warmup =</span> <span class="dv">2000</span>, </span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>)</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>h2.s2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h2.s2, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>h2.s2_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h2.s2)</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s2.rds"</span>))</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s2_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s2_R2.rds"</span>))</span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-24"><a href="#cb222-24" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can proceed as we usually do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>h2.s2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s2.rds"</span>))</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>h2.s2_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s2_R2.rds"</span>))</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h2.s2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Effort_Change ~ 1 + s(PrevAn, bs = "bs", k = 19) 
   Data: d2 (Number of observations: 2556) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sds(sPrevAn_1)     0.04      0.04     0.00     0.15 1.00     2227     4150

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.55      0.07     0.40     0.69 1.00    10619     5777
sPrevAn_1    -0.30      0.05    -0.39    -0.21 1.00     6524     5066

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     3.75      0.05     3.65     3.86 1.00    10144     5898

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2.s2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s2 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks good</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h2.s2), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s2 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># again, we see similar (non-linear) trend </span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s2, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s2 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as before, ignoring bimodality</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s2, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s2 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># still weird</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>h2.s2_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate   Est.Error       Q2.5      Q97.5
R2 0.02581913 0.006114862 0.01489172 0.03874999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explained variance 2%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="splines-3---gams-with-fr-effects" class="level2">
<h2 class="anchored" data-anchor-id="splines-3---gams-with-fr-effects">Splines 3 - GAMs with f+r effects</h2>
<p>Now let’s use the same model, but adding our other predictors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>h2.s3 <span class="ot">&lt;-</span> </span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> filtered_data,</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian,</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>    Effort_Change <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">s</span>(PrevAn_z, <span class="at">bs =</span> <span class="st">"bs"</span>, <span class="at">k =</span> <span class="dv">19</span>) <span class="sc">+</span>  <span class="co"># Smooth for Previous Answer similarity</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> CommAtt <span class="sc">+</span> Modality <span class="sc">+</span> Big5 <span class="sc">+</span> Familiarity <span class="sc">+</span> Expressibility_z <span class="sc">+</span>  <span class="co"># Fixed effects</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> Participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Concept),  <span class="co"># Random effects</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">4000</span>, </span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">warmup =</span> <span class="dv">2000</span>, </span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">4</span>,</span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>)</span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add criterions for later diagnostics</span></span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>h2.s3 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(h2.s3, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>, <span class="st">"waic"</span>))</span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate also variance explained (R^2)</span></span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a>h2.s3_R2 <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(h2.s3)</span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Save both as objects</span></span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s3, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s3.rds"</span>))</span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(h2.s3_R2, <span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s3_R2.rds"</span>))</span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-28"><a href="#cb232-28" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>h2.s3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s3.rds"</span>))</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>h2.s3_R2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"09_Analysis_Modeling"</span>, <span class="st">"models"</span>, <span class="st">"h2.s3_R2.rds"</span>))</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h2.s3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Effort_Change ~ 1 + s(PrevAn_z, bs = "bs", k = 19) + +CommAtt + Modality + Big5 + Familiarity + Expressibility_z + (1 | Participant) + (1 | Concept) 
   Data: filtered_data (Number of observations: 2556) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Smoothing Spline Hyperparameters:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sds(sPrevAn_z_1)     0.01      0.01     0.00     0.03 1.00     3075     4614

Multilevel Hyperparameters:
~Concept (Number of levels: 21) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.03      0.02     0.00     0.08 1.00     5219     4819

~Participant (Number of levels: 120) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.02      0.02     0.00     0.07 1.00     6622     4876

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           -0.66      0.03    -0.72    -0.61 1.00    15652     5457
CommAtt1             3.73      0.03     3.68     3.78 1.00    20938     5112
Modality1           -0.14      0.07    -0.27    -0.00 1.00    14396     6300
Modality2            0.01      0.07    -0.12     0.15 1.00    15298     7228
Big5                 0.14      0.04     0.05     0.23 1.00    18750     5647
Familiarity          0.15      0.05     0.06     0.24 1.00    22307     5918
Expressibility_z     0.08      0.03     0.02     0.14 1.00    21298     5485
sPrevAn_z_1         -0.32      0.01    -0.35    -0.30 1.00    17636     6556

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.25      0.02     1.21     1.28 1.00    22077     5247

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2.s3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks ok</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(h2.s3), <span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now the ffect of PrevAn looks a bit different because we are back to using z-scored version</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s3, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks ok but the ppd undershoots the low values and overshoot the high values, similar to the linear regression</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(h2.s3, <span class="at">type =</span> <span class="st">"error_scatter_avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2.s3 check-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># still not what we would like</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>h2.s3_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Estimate  Est.Error      Q2.5     Q97.5
R2 0.892084 0.00136303 0.8893236 0.8945848</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 89% variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagnostics-i-1" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics-i-1">Diagnostics I</h2>
<p>Before we proceed further, let’s do first round of diagnostics</p>
<section id="rhat-1" class="level3">
<h3 class="anchored" data-anchor-id="rhat-1">Rhat</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract R-hat values for each model</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>rhat_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_list, <span class="cf">function</span>(model) {</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  rhat_values <span class="ot">&lt;-</span> <span class="fu">rhat</span>(model)</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(model)), </span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">max_rhat =</span> <span class="fu">max</span>(rhat_values), </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_rhat =</span> <span class="fu">min</span>(rhat_values))</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and inspect</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind, rhat_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   model max_rhat  min_rhat
1 X[[i]] 1.003546 0.9996569
2 X[[i]] 1.003278 1.0003198
3 X[[i]] 1.001547 1.0000413
4 X[[i]] 1.002112 0.9996489</code></pre>
</div>
</div>
<p>All Rhat values look good</p>
</section>
<section id="ess-2" class="level3">
<h3 class="anchored" data-anchor-id="ess-2">ESS</h3>
<p>Effective sample size tells how many independent samples the model has effectively drawn from the PD. Low ESS suggests autocorrelation (i.e., sample explores one part of posterior), while high ESS means good mix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract n_eff values for each model</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>neff_ratio_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_list, <span class="cf">function</span>(model) {</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  neff_values <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(model)              <span class="co"># Here we calculate ratio (not the raw number of effective samples)</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(model)), </span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_neff =</span> <span class="fu">min</span>(neff_values), </span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">max_neff =</span> <span class="fu">max</span>(neff_values),</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">mean_neff =</span> <span class="fu">mean</span>(neff_values))</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and inspect</span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind, neff_ratio_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   model  min_neff  max_neff mean_neff
1 X[[i]] 0.3290114 0.9137058 0.8042730
2 X[[i]] 0.1277981 0.5329452 0.2049973
3 X[[i]] 0.2784304 0.7904525 0.6233618
4 X[[i]] 0.3166404 1.0163927 0.8098956</code></pre>
</div>
</div>
<p>They all look good expect the very first non-linear model h2.s1 which is quite expectable since we used only main predictor. Linear regression model and GAMs model have highest ESS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h2.m1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept 13719
2         b_PrevAn_z 17596
3         b_CommAtt1 19690
4      b_Familiarity 16236
5             b_Big5 16183
6 b_Expressibility_z 18846
7    b_TrialNumber_c 11127
8        b_Modality1 13781
9        b_Modality2 11755</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effective_sample</span>(h2.s3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Parameter   ESS
1        b_Intercept 15467
2         b_CommAtt1 20347
3        b_Modality1 14550
4        b_Modality2 15207
5             b_Big5 18402
6      b_Familiarity 22096
7 b_Expressibility_z 20936
8     bs_sPrevAn_z_1 17735</code></pre>
</div>
</div>
</section>
<section id="loo-waic-2" class="level3">
<h3 class="anchored" data-anchor-id="loo-waic-2">LOO &amp; WAIC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h2.m1, h2.s1, h2.s2, h2.s3, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic
h2.m1     0.0       0.0 -4201.7     48.1        14.8     0.7   8403.4    96.2 
h2.s3    -0.1       0.7 -4201.8     48.1        15.2     0.7   8403.6    96.3 
h2.s2 -2808.1      38.3 -7009.8     26.4         4.8     0.1  14019.6    52.7 
h2.s1 -2810.8      38.3 -7012.5     26.6         9.6     0.3  14025.0    53.3 </code></pre>
</div>
</div>
<p>Here again we see that GAM and LR model have best performance assessed by LOO.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(h2.m1, h2.s1, h2.s2, h2.s3, <span class="at">criterion =</span> <span class="st">"waic"</span>)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(w, <span class="at">simplify =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic   
h2.m1     0.0       0.0 -4201.7      48.1         14.8     0.7    8403.4
h2.s3    -0.1       0.7 -4201.8      48.1         15.2     0.7    8403.5
h2.s2 -2808.1      38.3 -7009.8      26.4          4.8     0.1   14019.6
h2.s1 -2810.8      38.3 -7012.5      26.6          9.6     0.3   14025.0
      se_waic
h2.m1    96.2
h2.s3    96.3
h2.s2    52.7
h2.s1    53.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see Solomon Kurz</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">waic_diff =</span> w[,<span class="dv">1</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">se =</span> w[,<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         waic_diff        se
h2.m1    0.0000000  0.000000
h2.s3    0.1437139  1.412563
h2.s2 5616.2358401 76.619424
h2.s1 5621.6500755 76.529817</code></pre>
</div>
</div>
<p>Plot the comparison</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Modelling_syntheticData_files/figure-html/h2 waic plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we see identical results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(h2.m1, h2.s1, h2.s2, h2.s3, <span class="at">weights =</span> <span class="st">"waic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>h2.m1 h2.s1 h2.s2 h2.s3 
 0.52  0.00  0.00  0.48 </code></pre>
</div>
</div>
<p>For the synthetic data, GAMs are probably adding unnecessary complexity as we are not gaining much more explanatory power. However, we leave it open whether linear or non-linear models will be better suited for the real data, following this pipeline.</p>
</section>
</section>
<section id="adding-priors" class="level2">
<h2 class="anchored" data-anchor-id="adding-priors">Adding priors</h2>
<p>Similarly to H1, we will also set mildly informative priors. Let’s check what priors have been selected as default for h2.s3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print priors</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(h2.s3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class                           coef       group
                 (flat)         b                                           
                 (flat)         b                           Big5            
                 (flat)         b                       CommAtt1            
                 (flat)         b               Expressibility_z            
                 (flat)         b                    Familiarity            
                 (flat)         b                      Modality1            
                 (flat)         b                      Modality2            
                 (flat)         b                    sPrevAn_z_1            
 student_t(3, 2.1, 2.7) Intercept                                           
   student_t(3, 0, 2.7)        sd                                           
   student_t(3, 0, 2.7)        sd                                    Concept
   student_t(3, 0, 2.7)        sd                      Intercept     Concept
   student_t(3, 0, 2.7)        sd                                Participant
   student_t(3, 0, 2.7)        sd                      Intercept Participant
   student_t(3, 0, 2.7)       sds                                           
   student_t(3, 0, 2.7)       sds s(PrevAn_z, bs = "bs", k = 19)            
   student_t(3, 0, 2.7)     sigma                                           
 resp dpar nlpar lb ub       source
                            default
                       (vectorized)
                       (vectorized)
                       (vectorized)
                       (vectorized)
                       (vectorized)
                       (vectorized)
                       (vectorized)
                            default
                  0         default
                  0    (vectorized)
                  0    (vectorized)
                  0    (vectorized)
                  0    (vectorized)
                  0         default
                  0    (vectorized)
                  0         default</code></pre>
</div>
</div>
<p>For the flat priors that have been selected as default, we can re-use our previous priors from H1. The priors could therefore look somewhat like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>priors_h2s4 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"sPrevAn_z_1"</span>),</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.50)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"CommAtt2M1"</span>),</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality1"</span>),</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Modality2"</span>),</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Big5"</span>),</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Familiarity"</span>),</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,0.25)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"Expressibility_z"</span>)</span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="adding-interactions" class="level2">
<h2 class="anchored" data-anchor-id="adding-interactions">Adding Interactions</h2>
<p>Because we are currently already reaching the ceiling of R^2, we are not going to add more interactions. However, we are not excluding the option of adding few interactions when using the real data. Possible interactions include:</p>
<ul>
<li><p>PrevAn x Modality - similarity affects the change in effort differently (e.g., vocal might still require more effort)</p></li>
<li><p>PrevAn x Expressibility - similarity in relation to effort might matter only for highly expressible concepts, and low expressible concepts are difficult to express, so also difficult to exaggerate</p></li>
<li><p>Familiarity x PrevAn - if the guess is really bad, only very familiar people might be motivated enough to put more effort</p></li>
<li><p>Big x PrevAn - same like with familiarity</p></li>
</ul>
<p>Similar to the workflow adopted in H1 modelling, we would fit two new models, one with priors and one with interactions, and perform another round of diagnostics to see which model seems to have the most predictive power.</p>
</section>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<p>Here is session information for reproducibility:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=German_Germany.utf8  LC_CTYPE=German_Germany.utf8   
[3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.utf8    

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] emmeans_1.11.0    lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    
 [5] purrr_1.0.4       readr_2.1.5       tidyverse_2.0.0   bayestestR_0.15.2
 [9] beepr_2.0         brms_2.22.0       Rcpp_1.0.14       bayesplot_1.11.1 
[13] dagitty_0.3-4     ggdag_0.2.13      patchwork_1.3.0   rcartocolor_2.1.1
[17] tibble_3.2.1      ggplot2_3.5.1     tidyr_1.3.1       dplyr_1.1.4      
[21] here_1.0.1       

loaded via a namespace (and not attached):
 [1] gridExtra_2.3        inline_0.3.21        rlang_1.1.5         
 [4] magrittr_2.0.3       matrixStats_1.5.0    compiler_4.4.1      
 [7] mgcv_1.9-1           loo_2.8.0            vctrs_0.6.5         
[10] reshape2_1.4.4       pkgconfig_2.0.3      crayon_1.5.3        
[13] fastmap_1.2.0        backports_1.5.0      labeling_0.4.3      
[16] ggraph_2.2.1         utf8_1.2.4           rmarkdown_2.29      
[19] tzdb_0.5.0           bit_4.6.0            xfun_0.52           
[22] cachem_1.1.0         jsonlite_2.0.0       tweenr_2.0.3        
[25] parallel_4.4.1       R6_2.6.1             stringi_1.8.7       
[28] StanHeaders_2.32.10  boot_1.3-30          estimability_1.5.1  
[31] rstan_2.32.7         knitr_1.50           audio_0.1-11        
[34] Matrix_1.7-0         igraph_2.1.4         timechange_0.3.0    
[37] tidyselect_1.2.1     abind_1.4-8          yaml_2.3.10         
[40] viridis_0.6.5        codetools_0.2-20     curl_6.2.2          
[43] pkgbuild_1.4.7       lattice_0.22-6       plyr_1.8.9          
[46] withr_3.0.2          bridgesampling_1.1-2 posterior_1.6.1     
[49] coda_0.19-4.1        evaluate_1.0.3       RcppParallel_5.1.10 
[52] polyclip_1.10-7      pillar_1.10.2        tensorA_0.36.2.1    
[55] checkmate_2.3.2      stats4_4.4.1         insight_1.1.0       
[58] distributional_0.5.0 generics_0.1.3       vroom_1.6.5         
[61] rprojroot_2.0.4      hms_1.1.3            rstantools_2.4.0    
[64] munsell_0.5.1        scales_1.3.0         glue_1.8.0          
[67] tools_4.4.1          mvtnorm_1.3-3        graphlayouts_1.2.2  
[70] tidygraph_1.3.1      grid_4.4.1           QuickJSR_1.7.0      
[73] colorspace_2.1-1     nlme_3.1-164         ggforce_0.4.2       
[76] cli_3.6.4            viridisLite_0.4.2    Brobdingnag_1.2-9   
[79] V8_6.0.3             gtable_0.3.6         digest_0.6.37       
[82] ggrepel_0.9.6        farver_2.1.2         memoise_2.0.1       
[85] htmltools_0.5.8.1    lifecycle_1.0.4      bit64_4.6.0-1       
[88] MASS_7.3-60.2       </code></pre>
</div>
</div>
</section>
<section id="references" class="level1">
<h1>References</h1>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-burkner17" class="csl-entry" role="listitem">
Bürkner, Paul-Christian. 2017. <span>“<span class="nocase">brms</span>: An <span>R</span> Package for <span>Bayesian</span> Multilevel Models Using <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 80 (1): 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-mcelreath18" class="csl-entry" role="listitem">
McElreath, Richard. 2018. <em>Statistical <span>Rethinking</span>: <span>A Bayesian Course</span> with <span>Examples</span> in <span>R</span> and <span>Stan</span></em>. New York: <span>Chapman and Hall/CRC</span>. <a href="https://doi.org/10.1201/9781315372495">https://doi.org/10.1201/9781315372495</a>.
</div>
<div id="ref-morris_etal19" class="csl-entry" role="listitem">
Morris, Tim P., Ian R. White, and Michael J. Crowther. 2019. <span>“Using Simulation Studies to Evaluate Statistical Methods.”</span> <em>Statistics in Medicine</em> 38 (11): 2074–2102. <a href="https://doi.org/10.1002/sim.8086">https://doi.org/10.1002/sim.8086</a>.
</div>
<div id="ref-wood17" class="csl-entry" role="listitem">
Wood, S. N. 2017. <em>Generalized <span>A</span>dditive <span>M</span>odels: An Introduction with <span>R</span></em>. 2nd ed. Chapman; Hall/CRC.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>